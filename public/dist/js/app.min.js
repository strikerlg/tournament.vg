!function(){"use strict";angular.module("vg.app",["ngAnimate","ui.router","firebase","validation.match","ordinal","ngFileUpload","ngImgur"])}(),function(){"use strict";function e(e,t){t.otherwise("/"),e.state("home",{url:"/",templateUrl:"app/home/home.htm",controller:"HomeController as home"}).state("registerOrLogin",{url:"/registerOrLogin",templateUrl:"/app/home/reg.htm",controller:"RegController as reg"}).state("profile",{url:"/profile/:username",templateUrl:"/app/home/profile.htm",controller:"ProfileController as profile"}).state("leaderboard",{url:"/leaderboard",templateUrl:"/app/home/leaderboard.htm",controller:"LeaderboardController as leaderboard"}).state("event",{url:"/event/:eventName/main",templateUrl:"/app/event/main.htm",controller:"EventMainController as event"}).state("customizeAvatar",{url:"/customizeAvatar",templateUrl:"/app/home/avatar.htm",controller:"AvatarController as avatar",resolve:{currentAuth:["AuthWrapper",function(e){return e.$requireAuth()}]}}).state("changePassword",{url:"/changePassword",templateUrl:"/app/home/changePassword.htm",controller:"ChangePasswordController as pwchange",resolve:{currentAuth:["AuthWrapper",function(e){return e.$requireAuth()}]}})}angular.module("vg.app").constant("FIREBASEDATA",{FBURL:"https://wolfscontests.firebaseio.com"}).config(e),e.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"use strict";function e(e,t,r,n,o,a){e.$on("$stateChangeError",function(e,t,n,o,a,i){"AUTH_REQUIRED"===i&&r.go("registerOrLogin")}),e.$on("$stateChangeSuccess",function(){if(o.$getAuth()){var t=o.$getAuth(),r=new Firebase(a.FBURL),i=n(r.child("users").child(t.uid));i.$bindTo(e,"profile").then(function(t){e.unbindFunction=t})}})}angular.module("vg.app").run(e),e.$inject=["$rootScope","$location","$state","$firebaseObject","AuthWrapper","FIREBASEDATA"]}(),function(){"use strict";function e(e,t,r,n,o,a,i,s){function c(t){var r=e.defer(),a=!1,i=new n.Firebase(s.FBURL+"/users");return i.once("value",function(e){o(function(){e.forEach(function(e){e.val().userName===t&&(a=!0)}),r.resolve(a)})}),r.promise}function l(t,r,n){var o=e.defer();return i.$createUser({email:t,password:r}).then(function(e){new Firebase(s.FBURL).child("users/"+e.uid).set({userName:n,role:"User"},function(e){return console.error(e),e.code}),new Firebase(s.FBURL).child("avatars").child(n).set("http://api.adorable.io/avatars/42/"+n),i.$authWithPassword({email:t,password:r}).then(function(){o.resolve("ACCOUNT_CREATED")})})["catch"](function(e){console.error(e),"EMAIL_TAKEN"===e.code&&o.resolve(e.code)}),o.promise}function u(t,r){var n=e.defer();return i.$authWithPassword({email:t,password:r}).then(function(e){n.resolve("LOGIN_SUCCESS")})["catch"](function(e){"INVALID_USER"===e.code?n.resolve("INVALID_USER"):"INVALID_PASSWORD"===e.code&&n.resolve("INVALID_PASSWORD")}),n.promise}function d(){i.$unauth(),t.unbindFunction()}this.testData="hello world!",this.checkIfUserExists=c,this.createNewUser=l,this.loginToAccount=u,this.logOut=d}angular.module("vg.app").service("authService",e),e.$inject=["$q","$rootScope","$state","$window","$timeout","$firebaseObject","AuthWrapper","FIREBASEDATA"]}(),function(){"use strict";function e(e,t){var r=new Firebase(t.FBURL);return e(r)}angular.module("vg.app").factory("AuthWrapper",e),e.$inject=["$firebaseAuth","FIREBASEDATA"]}(),function(){"use strict";function e(e,t,r,n,o){function a(e){m(e).then(function(t){var n=new Firebase(o.FBURL),a=r(n.child("standings").child(e));a.$loaded().then(function(){t.forEach(function(e){a[e.key]=e.position}),a.$save()})})}function i(t){var n=e.defer(),a=new Firebase(o.FBURL),i=r(a.child("contests").child(t).child("properties"));return n.resolve(i),n.promise}function s(){return w}function c(){A.forEach(function(e){if(e.scores){var r=$.map(e.scores,function(e){return e});r=t("orderBy")(r,"-score"),e.firstScore=r[0]}})}function l(t,r){{var n=e.defer();new Firebase(o.FBURL)}return d(t).then(function(e){e.forEach(function(e){e.camelName===r&&n.resolve(e)})}),n.promise}function u(){return A}function d(t){var r=e.defer(),a=new Firebase(o.FBURL),i=n(a.child("contests").child(t).child("activeGames"));return i.$loaded().then(function(){r.resolve(i)}),r.promise}function f(){return E}function m(r){var n=e.defer(),o={};return d(r).then(function(e){var r=e;r.forEach(function(e){if(e.scores){var r=$.map(e.scores,function(e){return e});r=t("orderBy")(r,"-score");for(var n=12,a=0;a<r.length;a++)o[r[a].userName]||(o[r[a].userName]={points:0}),o[r[a].userName].points+=n,n>0&&(n-=1)}}),o=t("orderObjectBy")(o,"points",!0);for(var a=!1,i=0,s=0;s<o.length;s+=1)if(o[s-1]&&o[s].points&&o[s-1].points)o[s].position=o[s].points===o[s-1].points?o[s-1].position:s+1;else if(0===s)o[s].position=1;else{if(!a){for(var c=o[s-1].points,l=0;l<o.length;l+=1)o[l].points===c&&(i+=1);a=!0}o[s].position=o.length+1-i}n.resolve(o)}),n.promise}function p(t){var r=e.defer(),a=new Firebase(o.FBURL),i=n(a.child("contests").child(t).child("scores"));return r.resolve(i),r.promise}function h(){return L}function v(){return S}function g(r,n,o){var a=e.defer(),i=[];return n.forEach(function(e){if(e.scores){var r=$.map(e.scores,function(e){return e});r=t("orderBy")(r,"-score");for(var n=12,a=0;a<r.length;a++){if(r[a].userName===o){var s=e;s.position=a+1,s.score=r[a].score,s.pointsEarned=n,s.inpUrl=r[a].inpUrl?r[a].inpUrl:null,s.twitchUrl=r[a].twitchUrl?r[a].twitchUrl:null,s.mameVersion=r[a].mameVersion?r[a].mameVersion:null,i.push(s),n=12;break}n>0&&(n-=1)}}}),a.resolve(i),a.promise}function b(e){var t=new Firebase(o.FBURL),n=r(t.child("contests").child(e).child("properties"));n.$loaded().then(function(){w=n,w.format.multiGame?(d(e).then(function(e){A=e,c()}),m(e).then(function(e){var t=e;E=t.length,L=t.slice(0,8)})):p(e).then(function(e){var t=e;E=t.length,L=t}),w.format.teamBased&&teamService.getTeamList(vm.eventName).then(function(e){S=e})})}var w=null,A=null,E=null,L=null,S=null;this.createMultiGameFinalStandings=a,this.getEventProperties=i,this.getEventPropertiesObject=s,this.getGameData=l,this.getGameListObject=u,this.getGamesList=d,this.getLeaderboardLengthValue=f,this.getMultiGameLeaderboard=m,this.getPlayerScores=g,this.getSingleGameLeaderboard=p,this.getSummarizedLeaderboardObject=h,this.getTeamListObject=v,this.loadEventProperties=b}angular.module("vg.app").service("eventService",e),e.$inject=["$q","$filter","$firebaseObject","$firebaseArray","FIREBASEDATA"]}(),function(){"use strict";function e(e,t,r,n,o,a,i,s,c,l,u){function d(){angular.element(".modal").closeModal()}function f(){l.createTeam(w.eventName,w.newTeam).then(function(){Materialize.toast("Team "+w.newTeam.shortName+" created.",4e3),w.newTeam=null})}function m(e,r){var n;if(r>11)return n=0;n=12-r;var o=t("orderBy")(w.gameScores,"-score");return o[r-1]&&o[r-1].score===e.score&&(n+=1),n}function p(e){d(),n.go("profile",{username:e})}function h(){i.loadEventProperties(w.eventName),c.getAvatarData().then(function(e){w.avatarData=e}),e.$watchCollection(function(){return i.getEventPropertiesObject()},function(e){w.eventProperties=e},!0),e.$watchCollection(function(){return i.getTeamListObject()},function(e){w.teamList=e},!0)}function v(e){1===angular.element("#lean-overlay").length?(d(),o(function(){angular.element(e).openModal(),angular.element(e+"Content").scrollTop(0)},450)):(angular.element(e).openModal(),angular.element(e+"Content").scrollTop(0))}function g(e){var t=new Firebase(u.FBURL);i.getGameData(w.eventName,e).then(function(e){w.gameData=e,w.gameScores=a(t.child("contests").child(w.eventName).child("activeGames").child(w.gameData.$id).child("scores"))}),v("#gameModal")}function $(){i.getMultiGameLeaderboard(w.eventName).then(function(e){w.completeLeaderboard=e}),v("#multiGameLeaderboardModal")}function b(e){w.focusPlayer=e,i.getPlayerScores(w.eventName,w.gameList,w.focusPlayer).then(function(e){w.playerScores=e}),v("#playerModal")}var w=this;w.eventName=r.eventName,w.createTeam=f,w.determinePoints=m,w.goToPlayerProfile=p,w.openGameModal=g,w.openModal=v,w.openMultiGameLeaderboardModal=$,w.openPlayerModal=b,h()}angular.module("vg.app").controller("EventMainController",e),e.$inject=["$scope","$filter","$stateParams","$state","$timeout","$firebaseArray","eventService","authService","profileService","teamService","FIREBASEDATA"]}(),function(){"use strict";function e(e,t,r,n){function o(t,o){var a=e.defer(),i=new Firebase(n.FBURL),s=r(i.child("contests").child(t).child("teamPool"));return s.$loaded().then(function(){s[o.shortName]={fullName:o.formalName},s.$save(),a.resolve()}),a.promise}function a(r){var o=e.defer(),a=new Firebase(n.FBURL),i=t(a.child("contests").child(r).child("teamPool"));return i.$loaded().then(function(){o.resolve(i)}),o.promise}this.createTeam=o,this.getTeamList=a}angular.module("vg.app").service("teamService",e),e.$inject=["$q","$firebaseArray","$firebaseObject","FIREBASEDATA"]}(),function(){"use strict";function e(e,t,r,n,o){function a(){e(function(){angular.element(".dropdown-button").dropdown({inDuration:300,outDuration:225,constrain_width:!1,hover:!1,gutter:-114,belowOrigin:!0})},400),e(function(){angular.element(".dropdown-button").dropdown({inDuration:300,outDuration:225,constrain_width:!1,hover:!1,gutter:-114,belowOrigin:!0})},1e3)}function i(){o.logOut(),r.location.reload()}var s=this;s.logOut=i,a()}angular.module("vg.app").controller("HeaderController",e),e.$inject=["$timeout","$rootScope","$window","$state","authService"]}(),function(){"use strict";function e(){return function(e,t,r){var n=[];return angular.forEach(e,function(e,t){e.key=t,n.push(e)}),n.sort(function(e,r){return e[t]>r[t]?1:-1}),r&&n.reverse(),n}}angular.module("vg.app").filter("orderObjectBy",e)}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"E",templateUrl:"./app/eventComponents/gamesList.directive.htm",scope:!1,transclude:!1};return e}function t(e,t){e.$watchCollection(function(){return t.getGameListObject()},function(t){e.$parent.$parent.event.gameList=t},!0)}angular.module("vg.app").directive("vgGamesList",e),t.$inject=["$scope","eventService"]}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"E",templateUrl:"./app/eventComponents/multiGameLeaderboard.directive.htm",scope:!1,transclude:!1};return e}function t(e,t){e.$watchCollection(function(){return t.getLeaderboardLengthValue()},function(t){e.$parent.$parent.event.leaderboardLength=t},!0),e.$watchCollection(function(){return t.getSummarizedLeaderboardObject()},function(t){e.$parent.$parent.event.summarizedLeaderboard=t},!0)}angular.module("vg.app").directive("vgMultiGameLeaderboard",e),t.$inject=["$scope","eventService"]}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"E",templateUrl:"./app/eventComponents/singleGameLeaderboard.directive.htm",scope:!1,transclude:!1};return e}function t(e,t){e.$watchCollection(function(){return t.getLeaderboardLengthValue()},function(t){e.$parent.$parent.event.leaderboardLength=t},!0),e.$watchCollection(function(){return t.getSummarizedLeaderboardObject()},function(t){e.$parent.$parent.event.summarizedLeaderboard=t},!0)}angular.module("vg.app").directive("vgSingleGameLeaderboard",e),t.$inject=["$scope","eventService"]}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"E",templateUrl:"./app/eventComponents/stickyMessage.directive.htm",scope:{properties:"="}};return e}function t(e){}angular.module("vg.app").directive("vgStickyMessage",e),t.$inject=["$timeout"]}(),function(){"use strict";function e(e,t,r,n,o,a,i){function s(){i.getAvatarData().then(function(e){l.avatarData=e}),n(function(){i.getBadgesData(e.profile.userName).then(function(e){l.badgesData=e})},500)}function c(){l.disableButton=!0,a.setAPIKey("Client-ID f53d6d5833b07bc"),a.upload(l.file).then(function(r){i.saveAvatarLink(r[0].link,e.profile.userName),Materialize.toast("Your avatar was uploaded",4e3),n(function(){t.go("home")},1e3)})}var l=this;l.uploadAvatar=c,s()}angular.module("vg.app").controller("AvatarController",e),e.$inject=["$rootScope","$state","$stateParams","$timeout","Upload","imgur","profileService"]}(),function(){"use strict";function e(e,t,r,n){function o(){e.pwChangeForm.$valid&&n.$changePassword({email:n.$getAuth().password.email,oldPassword:a.inputCurrentPassword,newPassword:a.inputNewPassword}).then(function(){Materialize.toast("Your password was changed.",4e3),t(function(){r.go("home")},1e3)})["catch"](function(e){"INVALID_PASSWORD"===e.code&&(a.showChangePasswordMessage=!0)})}var a=this;a.submitChangePassword=o}angular.module("vg.app").controller("ChangePasswordController",e),e.$inject=["$scope","$timeout","$state","AuthWrapper"]}(),function(){"use strict";function e(e,t){}angular.module("vg.app").controller("HomeController",e),e.$inject=["$scope","$timeout"]}(),function(){"use strict";function e(e,t,r,n,o){function a(){i().then(function(e){s.profileScoreData=e}),n.getAvatarData().then(function(e){s.avatarData=e})}function i(){var t=e.defer(),n=new Firebase(o.FBURL),a=r(n.child("badges"));return a.$loaded(function(){t.resolve(a)}),t.promise}var s=this;a()}angular.module("vg.app").controller("LeaderboardController",e),e.$inject=["$q","$timeout","$firebaseArray","profileService","FIREBASEDATA"]}(),function(){"use strict";function e(e,t,r,n,o,a,i,s,c){function l(){s.getUserData(t.username).then(function(e){u.profileData=e,s.getTournamentHistory(u.profileData).then(function(e){var r=e;u.eventStandings=s.getTournamentStandings(r,t.username)})}),s.getAvatarData().then(function(e){u.avatarData=e}),s.getBadgesData(t.username).then(function(e){u.badgesData=e,n(function(){angular.element(".collapsible").collapsible({accordion:!0})},200)})}var u=this;l()}angular.module("vg.app").controller("ProfileController",e),e.$inject=["$scope","$stateParams","$q","$timeout","$state","$firebaseArray","authService","profileService","eventService"]}(),function(){"use strict";function e(e,t,r,n,o,a){function i(){var e=t.defer(),r=new Firebase(a.FBURL),o=n(r.child("avatars"));return o.$loaded(function(){e.resolve(o)}),e.promise}function s(e){var r=t.defer(),o=new Firebase(a.FBURL),i=n(o.child("badges").child(e));return i.$loaded(function(){r.resolve(i)}),r.promise}function c(e){var r=t.defer(),n=(new Firebase(a.FBURL),[]);for(var o in e.pledgedTo)n.push(o);return r.resolve(n),r.promise}function l(e,t){var r=new Firebase(a.FBURL),i=[];return e.forEach(function(e){o.getEventProperties(e).then(function(o){o.$loaded().then(function(){if("concluded"===o.state){var a=n(r.child("standings").child(e));a.$loaded().then(function(){i.push(a[t]?{name:o.name,premier:o.premier?!0:null,shortName:e,state:"concluded",color:o.color,position:a[t]}:{name:o.name,premier:o.premier?!0:null,shortName:e,state:"concluded",color:o.color,position:-1})})}else("inprogress"===o.state||"upcoming"===o.state)&&i.push({name:o.name,premier:o.premier?!0:null,shortName:e,color:o.color,state:o.state})})})}),i}function u(e){var n=t.defer(),o=new Firebase(a.FBURL),i=r(o.child("users"));return i.$loaded(function(){i.forEach(function(t){t.userName===e&&n.resolve(t)})}),n.promise}function d(e,t){var r=new Firebase(a.FBURL),o=n(r.child("avatars"));o.$loaded(function(){o[t]=e,o.$save()})}this.getAvatarData=i,this.getBadgesData=s,this.getTournamentHistory=c,this.getTournamentStandings=l,this.getUserData=u,this.saveAvatarLink=d}angular.module("vg.app").service("profileService",e),e.$inject=["$rootScope","$q","$firebaseArray","$firebaseObject","eventService","FIREBASEDATA"]}(),function(){"use strict";function e(e,t,r,n,o,a,i,s){function c(){i.loginToAccount(d.loginEmail,d.loginPassword).then(function(e){if(d.showInvalidUserError=!1,d.showInvalidPasswordError=!1,"LOGIN_SUCCESS"===e)o.go("home");else{if("INVALID_USER"===e)return void(d.showInvalidUserError=!0);"INVALID_PASSWORD"===e&&(d.showInvalidPasswordError=!0)}})}function l(){return d.loginEmail?void s.$resetPassword({email:d.loginEmail}).then(function(){d.showPasswordResetEmailMessage=!1,Materialize.toast("A password reset email has been sent to "+d.loginEmail+".",4e3)}):void(d.showPasswordResetEmailMessage=!0)}function u(){i.checkIfUserExists(d.newUsername).then(function(e){return d.showDuplicateUserError=!1,d.showEmailTakenError=!1,e?void(d.showDuplicateUserError=!0):void i.createNewUser(d.newEmail,d.newPassword,d.newUsername).then(function(e){return"EMAIL_TAKEN"===e?void(d.showEmailTakenError=!0):void("ACCOUNT_CREATED"===e&&o.go("profile",{username:d.newUsername}))})})}var d=this;d.loginToAccount=c,d.passwordReset=l,d.submitNewAccount=u}angular.module("vg.app").controller("RegController",e),e.$inject=["$scope","$rootScope","$timeout","$window","$state","$firebaseObject","authService","AuthWrapper"]}();
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFwcC5tb2R1bGUuanMiLCJhcHAuY29uZmlnLmpzIiwiYXBwLm1pbi5qcyIsImFwcC5ydW4uanMiLCJhdXRoL2F1dGguc2VydmljZS5qcyIsImF1dGgvYXV0aHdyYXBwZXIuZmFjdG9yeS5qcyIsImV2ZW50L2V2ZW50LnNlcnZpY2UuanMiLCJldmVudC9tYWluLmNvbnRyb2xsZXIuanMiLCJldmVudC90ZWFtLnNlcnZpY2UuanMiLCJoZWFkZXIvaGVhZGVyLmNvbnRyb2xsZXIuanMiLCJoZWxwZXJzL29yZGVyT2JqZWN0QnkuZmlsdGVyLmpzIiwiZXZlbnRDb21wb25lbnRzL2dhbWVzTGlzdC5kaXJlY3RpdmUuanMiLCJldmVudENvbXBvbmVudHMvbXVsdGlHYW1lTGVhZGVyYm9hcmQuZGlyZWN0aXZlLmpzIiwiZXZlbnRDb21wb25lbnRzL3NpbmdsZUdhbWVMZWFkZXJib2FyZC5kaXJlY3RpdmUuanMiLCJldmVudENvbXBvbmVudHMvc3RpY2t5TWVzc2FnZS5kaXJlY3RpdmUuanMiLCJob21lL2F2YXRhci5jb250cm9sbGVyLmpzIiwiaG9tZS9jaGFuZ2VQYXNzd29yZC5jb250cm9sbGVyLmpzIiwiaG9tZS9ob21lLmNvbnRyb2xsZXIuanMiLCJob21lL2xlYWRlcmJvYXJkLmNvbnRyb2xsZXIuanMiLCJob21lL3Byb2ZpbGUuY29udHJvbGxlci5qcyIsImhvbWUvcHJvZmlsZS5zZXJ2aWNlLmpzIiwiaG9tZS9yZWcuY29udHJvbGxlci5qcyJdLCJuYW1lcyI6WyJhbmd1bGFyIiwibW9kdWxlIiwiY29uZmlnIiwiJHN0YXRlUHJvdmlkZXIiLCIkdXJsUm91dGVyUHJvdmlkZXIiLCJvdGhlcndpc2UiLCJzdGF0ZSIsInVybCIsInRlbXBsYXRlVXJsIiwiY29udHJvbGxlciIsInJlc29sdmUiLCJjdXJyZW50QXV0aCIsIkF1dGhXcmFwcGVyIiwiJHJlcXVpcmVBdXRoIiwiY29uc3RhbnQiLCJGQlVSTCIsIiRpbmplY3QiLCJydW4iLCIkcm9vdFNjb3BlIiwiJGxvY2F0aW9uIiwiJHN0YXRlIiwiJGZpcmViYXNlT2JqZWN0IiwiRklSRUJBU0VEQVRBIiwiJG9uIiwiZXZlbnQiLCJ0b1N0YXRlIiwidG9QYXJhbXMiLCJmcm9tU3RhdGUiLCJmcm9tUGFyYW1zIiwiZXJyb3IiLCJnbyIsIiRnZXRBdXRoIiwiYXV0aERhdGEiLCJyZWYiLCJGaXJlYmFzZSIsInByb2ZpbGVEYXRhIiwiY2hpbGQiLCJ1aWQiLCIkYmluZFRvIiwidGhlbiIsInVuYmluZCIsInVuYmluZEZ1bmN0aW9uIiwiYXV0aFNlcnZpY2UiLCIkcSIsIiR3aW5kb3ciLCIkdGltZW91dCIsImNoZWNrSWZVc2VyRXhpc3RzIiwiaW5wdXRVc2VybmFtZSIsImRlZmVycmVkIiwiZGVmZXIiLCJkb2VzVXNlckV4aXN0IiwidXNlcnNSZWYiLCJvbmNlIiwiZGF0YVNuYXBzaG90IiwiZm9yRWFjaCIsInVzZXIiLCJ2YWwiLCJ1c2VyTmFtZSIsInByb21pc2UiLCJjcmVhdGVOZXdVc2VyIiwiaW5wdXRFbWFpbCIsImlucHV0UGFzc3dvcmQiLCIkY3JlYXRlVXNlciIsImVtYWlsIiwicGFzc3dvcmQiLCJ1c2VyRGF0YSIsInNldCIsInJvbGUiLCJlcnJvckRhdGEiLCJjb25zb2xlIiwiY29kZSIsIiRhdXRoV2l0aFBhc3N3b3JkIiwibG9naW5Ub0FjY291bnQiLCJsb2dPdXQiLCIkdW5hdXRoIiwidGhpcyIsInRlc3REYXRhIiwic2VydmljZSIsIiRmaXJlYmFzZUF1dGgiLCJmYWN0b3J5IiwiZXZlbnRTZXJ2aWNlIiwiJGZpbHRlciIsIiRmaXJlYmFzZUFycmF5IiwiY3JlYXRlTXVsdGlHYW1lRmluYWxTdGFuZGluZ3MiLCJpbnB1dEV2ZW50IiwiZ2V0TXVsdGlHYW1lTGVhZGVyYm9hcmQiLCJtb2RlbCIsImlucHV0RXZlbnRTdGFuZGluZ3MiLCIkbG9hZGVkIiwic3RhbmRpbmciLCJrZXkiLCJwb3NpdGlvbiIsIiRzYXZlIiwiZ2V0RXZlbnRQcm9wZXJ0aWVzIiwiZXZlbnRQcm9wZXJ0aWVzIiwiZ2V0RXZlbnRQcm9wZXJ0aWVzT2JqZWN0IiwiX2V2ZW50UHJvcGVydGllcyIsImdldEZpcnN0UGxhY2VTY29yZXMiLCJfZ2FtZUxpc3QiLCJnYW1lIiwic2NvcmVzIiwic2NvcmVzQXJyYXkiLCIkIiwibWFwIiwiZWwiLCJmaXJzdFNjb3JlIiwiZ2V0R2FtZURhdGEiLCJpbnB1dEdhbWUiLCJnZXRHYW1lc0xpc3QiLCJnYW1lc0xpc3QiLCJjYW1lbE5hbWUiLCJnZXRHYW1lTGlzdE9iamVjdCIsImdldExlYWRlcmJvYXJkTGVuZ3RoVmFsdWUiLCJfbGVhZGVyYm9hcmRMZW5ndGgiLCJwbGF5ZXJQb2ludHMiLCJ0b3RhbEF3YXJkIiwiaSIsImxlbmd0aCIsInBvaW50cyIsImhhdmVCb3R0b21TY29yZXJzRmxvb3IiLCJmbG9vclJhbmdlIiwiZ2V0U2NvcmVDb3VudE9mIiwiaiIsImdldFNpbmdsZUdhbWVMZWFkZXJib2FyZCIsImxlYWRlcmJvYXJkRGF0YSIsImdldFN1bW1hcml6ZWRMZWFkZXJib2FyZE9iamVjdCIsIl9zdW1tYXJpemVkTGVhZGVyYm9hcmQiLCJnZXRUZWFtTGlzdE9iamVjdCIsIl90ZWFtTGlzdCIsImdldFBsYXllclNjb3JlcyIsImlucHV0R2FtZXNMaXN0IiwiaW5wdXRQbGF5ZXIiLCJkaXNwbGF5U2NvcmVzIiwibmV3U2NvcmVPYmplY3QiLCJzY29yZSIsInBvaW50c0Vhcm5lZCIsImlucFVybCIsInR3aXRjaFVybCIsIm1hbWVWZXJzaW9uIiwicHVzaCIsImxvYWRFdmVudFByb3BlcnRpZXMiLCJpbnB1dEV2ZW50UHJvcGVydGllcyIsImZvcm1hdCIsIm11bHRpR2FtZSIsImxlYWRlcmJvYXJkIiwic2xpY2UiLCJ0ZWFtQmFzZWQiLCJ0ZWFtU2VydmljZSIsImdldFRlYW1MaXN0Iiwidm0iLCJldmVudE5hbWUiLCJFdmVudE1haW5Db250cm9sbGVyIiwiJHNjb3BlIiwiJHN0YXRlUGFyYW1zIiwicHJvZmlsZVNlcnZpY2UiLCJjbG9zZU1vZGFsIiwiZWxlbWVudCIsImNyZWF0ZVRlYW0iLCJuZXdUZWFtIiwiTWF0ZXJpYWxpemUiLCJ0b2FzdCIsInNob3J0TmFtZSIsImRldGVybWluZVBvaW50cyIsImlucHV0U2NvcmVEYXRhIiwiaW5wdXRJbmRleCIsInVzZXJHYW1lUG9pbnRzIiwic29ydGVkU2NvcmVzIiwiZ2FtZVNjb3JlcyIsImdvVG9QbGF5ZXJQcm9maWxlIiwidXNlcm5hbWUiLCJpbml0RXZlbnQiLCJnZXRBdmF0YXJEYXRhIiwiYXZhdGFyRGF0YSIsIiR3YXRjaENvbGxlY3Rpb24iLCJ0ZWFtTGlzdCIsIm9wZW5Nb2RhbCIsImlucHV0TW9kYWwiLCJzY3JvbGxUb3AiLCJvcGVuR2FtZU1vZGFsIiwiaW5wdXRHYW1lTmFtZSIsImdhbWVEYXRhIiwiJGlkIiwib3Blbk11bHRpR2FtZUxlYWRlcmJvYXJkTW9kYWwiLCJjb21wbGV0ZUxlYWRlcmJvYXJkIiwib3BlblBsYXllck1vZGFsIiwiZm9jdXNQbGF5ZXIiLCJnYW1lTGlzdCIsInBsYXllclNjb3JlcyIsImlucHV0TmV3VGVhbVByb3BlcnRpZXMiLCJ0ZWFtUG9vbCIsImZ1bGxOYW1lIiwiZm9ybWFsTmFtZSIsIkhlYWRlckNvbnRyb2xsZXIiLCJhY3RpdmF0ZSIsImRyb3Bkb3duIiwiaW5EdXJhdGlvbiIsIm91dER1cmF0aW9uIiwiY29uc3RyYWluX3dpZHRoIiwiaG92ZXIiLCJndXR0ZXIiLCJiZWxvd09yaWdpbiIsImxvY2F0aW9uIiwicmVsb2FkIiwib3JkZXJPYmplY3RCeSIsIml0ZW1zIiwiZmllbGQiLCJyZXZlcnNlIiwiZmlsdGVyZWQiLCJpdGVtIiwic29ydCIsImEiLCJiIiwiZmlsdGVyIiwidmdHYW1lc0xpc3QiLCJkaXJlY3RpdmUiLCJiaW5kVG9Db250cm9sbGVyIiwiR2FtZXNMaXN0Q29udHJvbGxlciIsImNvbnRyb2xsZXJBcyIsInJlc3RyaWN0Iiwic2NvcGUiLCJ0cmFuc2NsdWRlIiwiJHBhcmVudCIsInZnTXVsdGlHYW1lTGVhZGVyYm9hcmQiLCJNdWx0aUdhbWVMZWFkZXJib2FyZENvbnRyb2xsZXIiLCJsZWFkZXJib2FyZExlbmd0aCIsInN1bW1hcml6ZWRMZWFkZXJib2FyZCIsInZnU2luZ2xlR2FtZUxlYWRlcmJvYXJkIiwiU2luZ2xlR2FtZUxlYWRlcmJvYXJkQ29udHJvbGxlciIsInZnU3RpY2t5TWVzc2FnZSIsIlN0aWNreU1lc3NhZ2VDb250cm9sbGVyIiwicHJvcGVydGllcyIsIkF2YXRhckNvbnRyb2xsZXIiLCJVcGxvYWQiLCJpbWd1ciIsImdldEJhZGdlc0RhdGEiLCJwcm9maWxlIiwiYmFkZ2VzRGF0YSIsInVwbG9hZEF2YXRhciIsImRpc2FibGVCdXR0b24iLCJzZXRBUElLZXkiLCJ1cGxvYWQiLCJmaWxlIiwic2F2ZUF2YXRhckxpbmsiLCJsaW5rIiwiQ2hhbmdlUGFzc3dvcmRDb250cm9sbGVyIiwic3VibWl0Q2hhbmdlUGFzc3dvcmQiLCJwd0NoYW5nZUZvcm0iLCIkdmFsaWQiLCIkY2hhbmdlUGFzc3dvcmQiLCJvbGRQYXNzd29yZCIsImlucHV0Q3VycmVudFBhc3N3b3JkIiwibmV3UGFzc3dvcmQiLCJpbnB1dE5ld1Bhc3N3b3JkIiwic2hvd0NoYW5nZVBhc3N3b3JkTWVzc2FnZSIsIkhvbWVDb250cm9sbGVyIiwiTGVhZGVyYm9hcmRDb250cm9sbGVyIiwiZ2V0UHJvZmlsZVNjb3JlcyIsInByb2ZpbGVTY29yZURhdGEiLCJQcm9maWxlQ29udHJvbGxlciIsImdldFVzZXJEYXRhIiwiZ2V0VG91cm5hbWVudEhpc3RvcnkiLCJ0b3VybmFtZW50SGlzdG9yeURhdGEiLCJldmVudFN0YW5kaW5ncyIsImdldFRvdXJuYW1lbnRTdGFuZGluZ3MiLCJjb2xsYXBzaWJsZSIsImFjY29yZGlvbiIsImlucHV0VXNlciIsImlucHV0VXNlckRhdGEiLCJldmVudHNBcnJheSIsInBsZWRnZWRUbyIsImlucHV0VG91cm5hbWVudEhpc3RvcnkiLCJldmVudFN0YW5kaW5nRGF0YSIsIm5hbWUiLCJwcmVtaWVyIiwiY29sb3IiLCJ1c2Vyc0RhdGEiLCJpbnB1dExpbmsiLCJSZWdDb250cm9sbGVyIiwibG9naW5FbWFpbCIsImxvZ2luUGFzc3dvcmQiLCJzaG93SW52YWxpZFVzZXJFcnJvciIsInNob3dJbnZhbGlkUGFzc3dvcmRFcnJvciIsInBhc3N3b3JkUmVzZXQiLCIkcmVzZXRQYXNzd29yZCIsInNob3dQYXNzd29yZFJlc2V0RW1haWxNZXNzYWdlIiwic3VibWl0TmV3QWNjb3VudCIsIm5ld1VzZXJuYW1lIiwidXNlckV4aXN0cyIsInNob3dEdXBsaWNhdGVVc2VyRXJyb3IiLCJzaG93RW1haWxUYWtlbkVycm9yIiwibmV3RW1haWwiXSwibWFwcGluZ3MiOiJDQUFBLFdBQ0EsWUFFQUEsU0FDQUMsT0FBQSxVQUVBLFlBR0EsWUFDQSxXQUNBLG1CQUNBLFVBQ0EsZUFDQSxlQ2RBLFdBQ0EsWUFVQSxTQUFBQyxHQUFBQyxFQUFBQyxHQUdBQSxFQUFBQyxVQUFBLEtBRUFGLEVBQ0FHLE1BQUEsUUFDQUMsSUFBQSxJQUNBQyxZQUFBLG9CQUNBQyxXQUFBLDJCQUdBSCxNQUFBLG1CQUNBQyxJQUFBLG1CQUNBQyxZQUFBLG9CQUNBQyxXQUFBLHlCQUdBSCxNQUFBLFdBQ0FDLElBQUEscUJBQ0FDLFlBQUEsd0JBQ0FDLFdBQUEsaUNBR0FILE1BQUEsZUFDQUMsSUFBQSxlQUNBQyxZQUFBLDRCQUNBQyxXQUFBLHlDQUdBSCxNQUFBLFNBQ0FDLElBQUEseUJBQ0FDLFlBQUEsc0JBQ0FDLFdBQUEsaUNBR0FILE1BQUEsbUJBQ0FDLElBQUEsbUJBQ0FDLFlBQUEsdUJBQ0FDLFdBQUEsNkJBRUFDLFNBQ0FDLGFBQUEsY0FBQSxTQUFBQyxHQUNBLE1BQUFBLEdBQUFDLG9CQUtBUCxNQUFBLGtCQUNBQyxJQUFBLGtCQUNBQyxZQUFBLCtCQUNBQyxXQUFBLHVDQUVBQyxTQUNBQyxhQUFBLGNBQUEsU0FBQUMsR0FDQSxNQUFBQSxHQUFBQyxvQkEvREFiLFFBQ0FDLE9BQUEsVUFDQWEsU0FBQSxnQkFDQUMsTUFBQSx5Q0FFQWIsT0FBQUEsR0MrRUNBLEVBQU9jLFNBQVcsaUJBQWtCLHlCQ3ZGckMsV0FDQSxZQU1B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QUEsV0FDQThHLEVBQUF1SSwrQkFBQSxFQUNBN0gsWUFBQUMsTUFBQSwyQ0FBQVgsRUFBQWlJLFdBQUEsSUFBQSxZQVJBakksRUFBQXVJLCtCQUFBLEdBYUEsUUFBQUMsS0FHQW5QLEVBQUFJLGtCQUFBdUcsRUFBQXlJLGFBQUF2UCxLQUFBLFNBQUF3UCxHQUtBLE1BSEExSSxHQUFBMkksd0JBQUEsRUFDQTNJLEVBQUE0SSxxQkFBQSxFQUVBRixPQUVBMUksRUFBQTJJLHdCQUFBLE9BTUF0UCxHQUFBaUIsY0FBQTBGLEVBQUE2SSxTQUFBN0ksRUFBQXNHLFlBQUF0RyxFQUFBeUksYUFBQXZQLEtBQUEsU0FBQStDLEdBRUEsTUFBQSxnQkFBQUEsT0FFQStELEVBQUE0SSxxQkFBQSxRQUdBLG9CQUFBM00sR0FFQWxFLEVBQUFVLEdBQUEsV0FBQTJJLFNBQUFwQixFQUFBeUksbUJBdkVBLEdBQUF6SSxHQUFBMUUsSUFFQTBFLEdBQUE3RSxlQUFBQSxFQUNBNkUsRUFBQXFJLGNBQUFBLEVBQ0FySSxFQUFBd0ksaUJBQUFBLEVBWkE3UixRQUNBQyxPQUFBLFVBQ0FRLFdBQUEsZ0JBQUE0USxHbkJzZ0RJQSxFQUFjclEsU0FBVyxTQUFVLGFBQWMsV0FBWSxVQUFXLFNBQVUsa0JBQW1CLGNBQWUiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3ZnLmFwcCcsIFtcbiAgICAgICAgICAgIC8qIEFuZ3VsYXIgbW9kdWxlcyAqL1xuICAgICAgICAgICAgJ25nQW5pbWF0ZScsXG4gICAgICAgICAgICAvKiBBcHAgbW9kdWxlcyAqL1xuICAgICAgICAgICAgLyogVGhpcmQtcGFydHkgbW9kdWxlcyAqL1xuICAgICAgICAgICAgJ3VpLnJvdXRlcicsXG4gICAgICAgICAgICAnZmlyZWJhc2UnLFxuICAgICAgICAgICAgJ3ZhbGlkYXRpb24ubWF0Y2gnLFxuICAgICAgICAgICAgJ29yZGluYWwnLFxuICAgICAgICAgICAgJ25nRmlsZVVwbG9hZCcsXG4gICAgICAgICAgICAnbmdJbWd1cidcbiAgICAgICAgXSk7XG59KSgpOyIsIihmdW5jdGlvbigpIHtcblx0J3VzZSBzdHJpY3QnO1xuXG5cdGFuZ3VsYXJcblx0XHQubW9kdWxlKCd2Zy5hcHAnKVxuXHRcdC5jb25zdGFudCgnRklSRUJBU0VEQVRBJywge1xuXHRcdFx0J0ZCVVJMJzogJ2h0dHBzOi8vd29sZnNjb250ZXN0cy5maXJlYmFzZWlvLmNvbSdcblx0XHR9KVxuXHRcdC5jb25maWcoY29uZmlnKTtcblxuXHQvKiBAbmdJbmplY3QgKi9cblx0ZnVuY3Rpb24gY29uZmlnKCRzdGF0ZVByb3ZpZGVyLCAkdXJsUm91dGVyUHJvdmlkZXIpIHtcblxuXHRcdC8vIFJlZGlyZWN0IGFueSB1bm1hdGNoZWQgVVJMIHRvIC8uXG5cdFx0JHVybFJvdXRlclByb3ZpZGVyLm90aGVyd2lzZSgnLycpO1xuXG5cdFx0JHN0YXRlUHJvdmlkZXJcblx0XHQgICAgLnN0YXRlKCdob21lJywge1xuXHRcdCAgICBcdHVybDogJy8nLFxuXHRcdCAgICBcdHRlbXBsYXRlVXJsOiAnYXBwL2hvbWUvaG9tZS5odG0nLFxuXHRcdCAgICBcdGNvbnRyb2xsZXI6ICdIb21lQ29udHJvbGxlciBhcyBob21lJ1xuXHRcdCAgICB9KVxuXG5cdFx0ICAgIC5zdGF0ZSgncmVnaXN0ZXJPckxvZ2luJywge1xuXHRcdCAgICBcdHVybDogJy9yZWdpc3Rlck9yTG9naW4nLFxuXHRcdCAgICBcdHRlbXBsYXRlVXJsOiAnL2FwcC9ob21lL3JlZy5odG0nLFxuXHRcdCAgICBcdGNvbnRyb2xsZXI6ICdSZWdDb250cm9sbGVyIGFzIHJlZydcblx0XHQgICAgfSlcblxuXHRcdCAgICAuc3RhdGUoJ3Byb2ZpbGUnLCB7XG5cdFx0ICAgIFx0dXJsOiAnL3Byb2ZpbGUvOnVzZXJuYW1lJyxcblx0XHQgICAgXHR0ZW1wbGF0ZVVybDogJy9hcHAvaG9tZS9wcm9maWxlLmh0bScsXG5cdFx0ICAgIFx0Y29udHJvbGxlcjogJ1Byb2ZpbGVDb250cm9sbGVyIGFzIHByb2ZpbGUnXG5cdFx0ICAgIH0pXG5cblx0XHQgICAgLnN0YXRlKCdsZWFkZXJib2FyZCcsIHtcblx0XHQgICAgXHR1cmw6ICcvbGVhZGVyYm9hcmQnLFxuXHRcdCAgICBcdHRlbXBsYXRlVXJsOiAnL2FwcC9ob21lL2xlYWRlcmJvYXJkLmh0bScsXG5cdFx0ICAgIFx0Y29udHJvbGxlcjogJ0xlYWRlcmJvYXJkQ29udHJvbGxlciBhcyBsZWFkZXJib2FyZCdcblx0XHQgICAgfSlcblxuXHRcdCAgICAuc3RhdGUoJ2V2ZW50Jywge1xuXHRcdCAgICBcdHVybDogJy9ldmVudC86ZXZlbnROYW1lL21haW4nLFxuXHRcdCAgICBcdHRlbXBsYXRlVXJsOiAnL2FwcC9ldmVudC9tYWluLmh0bScsXG5cdFx0ICAgIFx0Y29udHJvbGxlcjogJ0V2ZW50TWFpbkNvbnRyb2xsZXIgYXMgZXZlbnQnXG5cdFx0ICAgIH0pXG5cblx0XHQgICAgLnN0YXRlKCdjdXN0b21pemVBdmF0YXInLCB7XG5cdFx0ICAgIFx0dXJsOiAnL2N1c3RvbWl6ZUF2YXRhcicsXG5cdFx0ICAgIFx0dGVtcGxhdGVVcmw6ICcvYXBwL2hvbWUvYXZhdGFyLmh0bScsXG5cdFx0ICAgIFx0Y29udHJvbGxlcjogJ0F2YXRhckNvbnRyb2xsZXIgYXMgYXZhdGFyJyxcblxuXHRcdCAgICBcdHJlc29sdmU6IHtcblx0XHQgICAgXHRcdCdjdXJyZW50QXV0aCc6IFsnQXV0aFdyYXBwZXInLCBmdW5jdGlvbihBdXRoV3JhcHBlcikge1xuXHRcdCAgICBcdFx0XHRyZXR1cm4gQXV0aFdyYXBwZXIuJHJlcXVpcmVBdXRoKCk7XG5cdFx0ICAgIFx0XHR9XVxuXHRcdCAgICBcdH1cblx0XHQgICAgfSlcblxuXHRcdCAgICAuc3RhdGUoJ2NoYW5nZVBhc3N3b3JkJywge1xuXHRcdCAgICBcdHVybDogJy9jaGFuZ2VQYXNzd29yZCcsXG5cdFx0ICAgIFx0dGVtcGxhdGVVcmw6ICcvYXBwL2hvbWUvY2hhbmdlUGFzc3dvcmQuaHRtJyxcblx0XHQgICAgXHRjb250cm9sbGVyOiAnQ2hhbmdlUGFzc3dvcmRDb250cm9sbGVyIGFzIHB3Y2hhbmdlJyxcblxuXHRcdCAgICBcdHJlc29sdmU6IHtcblx0XHQgICAgXHRcdCdjdXJyZW50QXV0aCc6IFsnQXV0aFdyYXBwZXInLCBmdW5jdGlvbihBdXRoV3JhcHBlcikge1xuXHRcdCAgICBcdFx0XHRyZXR1cm4gQXV0aFdyYXBwZXIuJHJlcXVpcmVBdXRoKCk7XG5cdFx0ICAgIFx0XHR9XVxuXHRcdCAgICBcdH1cblx0XHQgICAgfSk7XG5cdH1cbn0pKCk7IixudWxsLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCd2Zy5hcHAnKVxuICAgICAgICAucnVuKHJ1bik7XG5cbiAgICBmdW5jdGlvbiBydW4oJHJvb3RTY29wZSwgJGxvY2F0aW9uLCAkc3RhdGUsICRmaXJlYmFzZU9iamVjdCwgQXV0aFdyYXBwZXIsIEZJUkVCQVNFREFUQSkge1xuXG4gICAgICAgICRyb290U2NvcGUuJG9uKCckc3RhdGVDaGFuZ2VFcnJvcicsIGZ1bmN0aW9uKGV2ZW50LCB0b1N0YXRlLCB0b1BhcmFtcywgZnJvbVN0YXRlLCBmcm9tUGFyYW1zLCBlcnJvcikge1xuICAgICAgICAgICAgaWYgKGVycm9yID09PSAnQVVUSF9SRVFVSVJFRCcpIHtcbiAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ3JlZ2lzdGVyT3JMb2dpbicpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcblxuICAgICAgICAkcm9vdFNjb3BlLiRvbignJHN0YXRlQ2hhbmdlU3VjY2VzcycsIGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAvLyBJZiB1c2VyIGlzIGxvZ2dlZCBpbiwgZG93bmxvYWQgdGhlaXIgcHJvZmlsZSBkYXRhIHRvIGFuIG9iamVjdCBpbiAkcm9vdFNjb3BlLlxuICAgICAgICAgICAgLy8gRklYTUU6IFdlIHNob3VsZG4ndCBuZWVkIHRvIGRvIHRoaXMgZXZlcnkgc3VjY2Vzc2Z1bCBzdGF0ZSBjaGFuZ2UuXG4gICAgICAgICAgICBpZiAoQXV0aFdyYXBwZXIuJGdldEF1dGgoKSkge1xuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIHZhciBhdXRoRGF0YSA9IEF1dGhXcmFwcGVyLiRnZXRBdXRoKCk7XG4gICAgICAgICAgICAgICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGSVJFQkFTRURBVEEuRkJVUkwpO1xuXG4gICAgICAgICAgICAgICAgdmFyIHByb2ZpbGVEYXRhID0gJGZpcmViYXNlT2JqZWN0KHJlZi5jaGlsZCgndXNlcnMnKS5jaGlsZChhdXRoRGF0YS51aWQpKTtcbiAgICAgICAgICAgICAgICBwcm9maWxlRGF0YS4kYmluZFRvKCRyb290U2NvcGUsICdwcm9maWxlJykudGhlbihmdW5jdGlvbih1bmJpbmQpIHtcbiAgICAgICAgICAgICAgICAgICAgJHJvb3RTY29wZS51bmJpbmRGdW5jdGlvbiA9IHVuYmluZDtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgfVxuXG4gICAgICAgIH0pO1xuXG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3ZnLmFwcCcpXG4gICAgICAgIC5zZXJ2aWNlKCdhdXRoU2VydmljZScsIGF1dGhTZXJ2aWNlKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIGF1dGhTZXJ2aWNlKCRxLCAkcm9vdFNjb3BlLCAkc3RhdGUsICR3aW5kb3csICR0aW1lb3V0LCAkZmlyZWJhc2VPYmplY3QsIEF1dGhXcmFwcGVyLCBGSVJFQkFTRURBVEEpIHtcbiAgICAgICAgXG4gICAgICAgIHRoaXMudGVzdERhdGEgPSAnaGVsbG8gd29ybGQhJztcblxuICAgIFx0dGhpcy5jaGVja0lmVXNlckV4aXN0cyA9IGNoZWNrSWZVc2VyRXhpc3RzO1xuICAgIFx0dGhpcy5jcmVhdGVOZXdVc2VyID0gY3JlYXRlTmV3VXNlcjtcbiAgICAgICAgdGhpcy5sb2dpblRvQWNjb3VudCA9IGxvZ2luVG9BY2NvdW50O1xuICAgICAgICB0aGlzLmxvZ091dCA9IGxvZ091dDtcblxuICAgIFx0Ly8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgXHRmdW5jdGlvbiBjaGVja0lmVXNlckV4aXN0cyhpbnB1dFVzZXJuYW1lKSB7XG5cbiAgICBcdFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblxuICAgIFx0XHR2YXIgZG9lc1VzZXJFeGlzdCA9IGZhbHNlO1xuICAgIFx0XHR2YXIgdXNlcnNSZWYgPSBuZXcgJHdpbmRvdy5GaXJlYmFzZShGSVJFQkFTRURBVEEuRkJVUkwgKyAnL3VzZXJzJyk7XG5cbiAgICBcdFx0dXNlcnNSZWYub25jZSgndmFsdWUnLCBmdW5jdGlvbihkYXRhU25hcHNob3QpIHtcblxuICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBkYXRhU25hcHNob3QuZm9yRWFjaChmdW5jdGlvbih1c2VyKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodXNlci52YWwoKS51c2VyTmFtZSA9PT0gaW5wdXRVc2VybmFtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGRvZXNVc2VyRXhpc3QgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGRvZXNVc2VyRXhpc3QpO1xuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgXHRcdH0pO1xuXG4gICAgXHRcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuXG4gICAgXHR9XG5cbiAgICBcdGZ1bmN0aW9uIGNyZWF0ZU5ld1VzZXIoaW5wdXRFbWFpbCwgaW5wdXRQYXNzd29yZCwgaW5wdXRVc2VybmFtZSkge1xuXG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgXHRcdEF1dGhXcmFwcGVyLiRjcmVhdGVVc2VyKHtcbiAgICBcdFx0XHRlbWFpbDogaW5wdXRFbWFpbCxcbiAgICBcdFx0XHRwYXNzd29yZDogaW5wdXRQYXNzd29yZFxuICAgIFx0XHR9KS50aGVuKGZ1bmN0aW9uKHVzZXJEYXRhKSB7XG5cbiAgICBcdFx0XHQvLyBDcmVhdGUgYSBkYXRhIGVudHJ5IGZvciB0aGUgbmV3IHVzZXJuYW1lLlxuICAgIFx0XHRcdG5ldyBGaXJlYmFzZShGSVJFQkFTRURBVEEuRkJVUkwpLmNoaWxkKCd1c2Vycy8nICsgdXNlckRhdGEudWlkKS5zZXQoe1xuXG4gICAgXHRcdFx0XHR1c2VyTmFtZTogaW5wdXRVc2VybmFtZSxcbiAgICBcdFx0XHRcdHJvbGU6ICdVc2VyJ1xuXG4gICAgXHRcdFx0fSwgZnVuY3Rpb24oZXJyb3JEYXRhKSB7XG4gICAgXHRcdFx0XHRjb25zb2xlLmVycm9yKGVycm9yRGF0YSk7XG4gICAgICAgICAgICAgICAgICAgIHJldHVybiBlcnJvckRhdGEuY29kZTtcbiAgICBcdFx0XHR9KTtcblxuICAgICAgICAgICAgICAgIC8vIENyZWF0ZSBhIGRhdGEgZW50cnkgZm9yIHRoZSB1c2VyJ3MgYXZhdGFyLlxuICAgICAgICAgICAgICAgIG5ldyBGaXJlYmFzZShGSVJFQkFTRURBVEEuRkJVUkwpLmNoaWxkKCdhdmF0YXJzJykuY2hpbGQoaW5wdXRVc2VybmFtZSkuc2V0KCdodHRwOi8vYXBpLmFkb3JhYmxlLmlvL2F2YXRhcnMvNDIvJyArIGlucHV0VXNlcm5hbWUpO1xuXG4gICAgXHRcdFx0Ly8gTG9nIHRoZSB1c2VyIGluLlxuICAgIFx0XHRcdEF1dGhXcmFwcGVyLiRhdXRoV2l0aFBhc3N3b3JkKHtcbiAgICBcdFx0XHRcdGVtYWlsOiBpbnB1dEVtYWlsLFxuICAgIFx0XHRcdFx0cGFzc3dvcmQ6IGlucHV0UGFzc3dvcmRcbiAgICBcdFx0XHR9KS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCdBQ0NPVU5UX0NSRUFURUQnKTtcbiAgICAgICAgICAgICAgICB9KTtcblxuICAgIFx0XHR9KS5jYXRjaChmdW5jdGlvbihlcnJvckRhdGEpIHtcblxuICAgIFx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyb3JEYXRhKTtcblxuICAgIFx0XHRcdGlmIChlcnJvckRhdGEuY29kZSA9PT0gJ0VNQUlMX1RBS0VOJykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGVycm9yRGF0YS5jb2RlKTtcbiAgICBcdFx0XHR9XG5cbiAgICBcdFx0fSk7XG5cbiAgICAgICAgICAgIHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuXG4gICAgXHR9XG5cbiAgICAgICAgZnVuY3Rpb24gbG9naW5Ub0FjY291bnQoaW5wdXRFbWFpbCwgaW5wdXRQYXNzd29yZCkge1xuXG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICBBdXRoV3JhcHBlci4kYXV0aFdpdGhQYXNzd29yZCh7XG4gICAgICAgICAgICAgICAgZW1haWw6IGlucHV0RW1haWwsXG4gICAgICAgICAgICAgICAgcGFzc3dvcmQ6IGlucHV0UGFzc3dvcmRcbiAgICAgICAgICAgIH0pLnRoZW4oZnVuY3Rpb24oYXV0aERhdGEpIHtcblxuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoJ0xPR0lOX1NVQ0NFU1MnKTtcblxuICAgICAgICAgICAgfSkuY2F0Y2goZnVuY3Rpb24oZXJyb3JEYXRhKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoZXJyb3JEYXRhLmNvZGUgPT09ICdJTlZBTElEX1VTRVInKSB7XG4gICAgICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoJ0lOVkFMSURfVVNFUicpO1xuICAgICAgICAgICAgICAgIH0gZWxzZSBpZiAoZXJyb3JEYXRhLmNvZGUgPT09ICdJTlZBTElEX1BBU1NXT1JEJykge1xuICAgICAgICAgICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKCdJTlZBTElEX1BBU1NXT1JEJyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGxvZ091dCgpIHtcbiAgICAgICAgICAgIEF1dGhXcmFwcGVyLiR1bmF1dGgoKTtcbiAgICAgICAgICAgICRyb290U2NvcGUudW5iaW5kRnVuY3Rpb24oKTtcbiAgICAgICAgfVxuXG4gICAgfVxufSkoKTsiLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCd2Zy5hcHAnKVxuICAgICAgICAuZmFjdG9yeSgnQXV0aFdyYXBwZXInLCBBdXRoV3JhcHBlcik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBBdXRoV3JhcHBlcigkZmlyZWJhc2VBdXRoLCBGSVJFQkFTRURBVEEpIHtcblxuICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZJUkVCQVNFREFUQS5GQlVSTCk7XG4gICAgICAgIHJldHVybiAkZmlyZWJhc2VBdXRoKHJlZik7XG5cbiAgICB9XG4gICAgXG59KSgpOyIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3ZnLmFwcCcpXG4gICAgICAgIC5zZXJ2aWNlKCdldmVudFNlcnZpY2UnLCBldmVudFNlcnZpY2UpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gZXZlbnRTZXJ2aWNlKCRxLCAkZmlsdGVyLCAkZmlyZWJhc2VPYmplY3QsICRmaXJlYmFzZUFycmF5LCBGSVJFQkFTRURBVEEpIHtcblxuICAgICAgICB2YXIgX2V2ZW50UHJvcGVydGllcyA9IG51bGw7XG4gICAgICAgIHZhciBfZ2FtZUxpc3QgPSBudWxsO1xuICAgICAgICB2YXIgX2xlYWRlcmJvYXJkTGVuZ3RoID0gbnVsbDtcbiAgICAgICAgdmFyIF9zdW1tYXJpemVkTGVhZGVyYm9hcmQgPSBudWxsO1xuICAgICAgICB2YXIgX3RlYW1MaXN0ID0gbnVsbDtcblxuICAgICAgICB0aGlzLmNyZWF0ZU11bHRpR2FtZUZpbmFsU3RhbmRpbmdzID0gY3JlYXRlTXVsdGlHYW1lRmluYWxTdGFuZGluZ3M7XG4gICAgICAgIHRoaXMuZ2V0RXZlbnRQcm9wZXJ0aWVzID0gZ2V0RXZlbnRQcm9wZXJ0aWVzO1xuICAgICAgICB0aGlzLmdldEV2ZW50UHJvcGVydGllc09iamVjdCA9IGdldEV2ZW50UHJvcGVydGllc09iamVjdDtcbiAgICAgICAgdGhpcy5nZXRHYW1lRGF0YSA9IGdldEdhbWVEYXRhO1xuICAgICAgICB0aGlzLmdldEdhbWVMaXN0T2JqZWN0ID0gZ2V0R2FtZUxpc3RPYmplY3Q7XG4gICAgICAgIHRoaXMuZ2V0R2FtZXNMaXN0ID0gZ2V0R2FtZXNMaXN0O1xuICAgICAgICB0aGlzLmdldExlYWRlcmJvYXJkTGVuZ3RoVmFsdWUgPSBnZXRMZWFkZXJib2FyZExlbmd0aFZhbHVlO1xuICAgICAgICB0aGlzLmdldE11bHRpR2FtZUxlYWRlcmJvYXJkID0gZ2V0TXVsdGlHYW1lTGVhZGVyYm9hcmQ7XG4gICAgICAgIHRoaXMuZ2V0UGxheWVyU2NvcmVzID0gZ2V0UGxheWVyU2NvcmVzO1xuICAgICAgICB0aGlzLmdldFNpbmdsZUdhbWVMZWFkZXJib2FyZCA9IGdldFNpbmdsZUdhbWVMZWFkZXJib2FyZDtcbiAgICAgICAgdGhpcy5nZXRTdW1tYXJpemVkTGVhZGVyYm9hcmRPYmplY3QgPSBnZXRTdW1tYXJpemVkTGVhZGVyYm9hcmRPYmplY3Q7XG4gICAgICAgIHRoaXMuZ2V0VGVhbUxpc3RPYmplY3QgPSBnZXRUZWFtTGlzdE9iamVjdDtcbiAgICAgICAgdGhpcy5sb2FkRXZlbnRQcm9wZXJ0aWVzID0gbG9hZEV2ZW50UHJvcGVydGllcztcblxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gY3JlYXRlTXVsdGlHYW1lRmluYWxTdGFuZGluZ3MoaW5wdXRFdmVudCkge1xuXG4gICAgICAgICAgICAvLyBDYWxjdWxhdGUgdGhlIGZpbmFsIHN0YW5kaW5ncyBvZiB0aGUgZXZlbnQuXG4gICAgICAgICAgICBnZXRNdWx0aUdhbWVMZWFkZXJib2FyZChpbnB1dEV2ZW50KS50aGVuKGZ1bmN0aW9uIHRoZW4obW9kZWwpIHtcblxuICAgICAgICAgICAgICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRklSRUJBU0VEQVRBLkZCVVJMKTtcbiAgICAgICAgICAgICAgICB2YXIgaW5wdXRFdmVudFN0YW5kaW5ncyA9ICRmaXJlYmFzZU9iamVjdChcbiAgICAgICAgICAgICAgICAgICAgcmVmXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2hpbGQoJ3N0YW5kaW5ncycpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2hpbGQoaW5wdXRFdmVudClcbiAgICAgICAgICAgICAgICApO1xuXG4gICAgICAgICAgICAgICAgaW5wdXRFdmVudFN0YW5kaW5ncy4kbG9hZGVkKCkudGhlbihmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICBtb2RlbC5mb3JFYWNoKGZ1bmN0aW9uKHN0YW5kaW5nKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbnB1dEV2ZW50U3RhbmRpbmdzW3N0YW5kaW5nLmtleV0gPSBzdGFuZGluZy5wb3NpdGlvbjtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgaW5wdXRFdmVudFN0YW5kaW5ncy4kc2F2ZSgpO1xuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRFdmVudFByb3BlcnRpZXMoaW5wdXRFdmVudCkge1xuXG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgIFx0dmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGSVJFQkFTRURBVEEuRkJVUkwpO1xuICAgICAgICBcdHZhciBldmVudFByb3BlcnRpZXMgPSAkZmlyZWJhc2VPYmplY3QoXG4gICAgICAgIFx0XHRyZWZcbiAgICAgICAgXHRcdFx0LmNoaWxkKCdjb250ZXN0cycpXG4gICAgICAgIFx0XHRcdC5jaGlsZChpbnB1dEV2ZW50KVxuICAgICAgICBcdFx0XHQuY2hpbGQoJ3Byb3BlcnRpZXMnKVxuICAgICAgICBcdCk7XG5cbiAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoZXZlbnRQcm9wZXJ0aWVzKTtcblxuICAgICAgICBcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRFdmVudFByb3BlcnRpZXNPYmplY3QoKSB7XG4gICAgICAgICAgICByZXR1cm4gX2V2ZW50UHJvcGVydGllcztcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEZpcnN0UGxhY2VTY29yZXMoKSB7XG5cbiAgICAgICAgICAgIF9nYW1lTGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGdhbWUpIHtcblxuICAgICAgICAgICAgICAgIC8vIElmIHRoZXJlIGFyZSBzY29yZXMsIGdldCB0aGUgdG9wIG9uZS5cbiAgICAgICAgICAgICAgICBpZiAoZ2FtZS5zY29yZXMpIHtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgc2NvcmVzQXJyYXkgPSAkLm1hcChnYW1lLnNjb3JlcywgZnVuY3Rpb24oZWwpIHsgcmV0dXJuIGVsOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcmVzQXJyYXkgPSAkZmlsdGVyKCdvcmRlckJ5Jykoc2NvcmVzQXJyYXksICctc2NvcmUnKTtcbiAgICAgICAgICAgICAgICAgICAgZ2FtZS5maXJzdFNjb3JlID0gc2NvcmVzQXJyYXlbMF07XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRHYW1lRGF0YShpbnB1dEV2ZW50LCBpbnB1dEdhbWUpIHtcblxuICAgICAgICAgICAgdmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICAgICAgdmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGSVJFQkFTRURBVEEuRkJVUkwpO1xuXG4gICAgICAgICAgICBnZXRHYW1lc0xpc3QoaW5wdXRFdmVudCkudGhlbihmdW5jdGlvbihnYW1lc0xpc3QpIHtcblxuICAgICAgICAgICAgICAgIGdhbWVzTGlzdC5mb3JFYWNoKGZ1bmN0aW9uKGdhbWUpIHtcblxuICAgICAgICAgICAgICAgICAgICBpZiAoZ2FtZS5jYW1lbE5hbWUgPT09IGlucHV0R2FtZSkge1xuICAgICAgICAgICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShnYW1lKTtcbiAgICAgICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0R2FtZUxpc3RPYmplY3QoKSB7XG4gICAgICAgICAgICByZXR1cm4gX2dhbWVMaXN0O1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0R2FtZXNMaXN0KGlucHV0RXZlbnQpIHtcblxuICAgICAgICBcdHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgXHR2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZJUkVCQVNFREFUQS5GQlVSTCk7XG4gICAgICAgIFx0dmFyIGdhbWVzTGlzdCA9ICRmaXJlYmFzZUFycmF5KFxuICAgICAgICBcdFx0cmVmXG4gICAgICAgIFx0XHRcdC5jaGlsZCgnY29udGVzdHMnKVxuICAgICAgICBcdFx0XHQuY2hpbGQoaW5wdXRFdmVudClcbiAgICAgICAgXHRcdFx0LmNoaWxkKCdhY3RpdmVHYW1lcycpXG4gICAgICAgIFx0KTtcblxuICAgICAgICBcdGdhbWVzTGlzdC4kbG9hZGVkKCkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgXHRcdGRlZmVycmVkLnJlc29sdmUoZ2FtZXNMaXN0KTtcbiAgICAgICAgXHR9KTtcblxuICAgICAgICBcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRMZWFkZXJib2FyZExlbmd0aFZhbHVlKCkge1xuICAgICAgICAgICAgcmV0dXJuIF9sZWFkZXJib2FyZExlbmd0aDtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldE11bHRpR2FtZUxlYWRlcmJvYXJkKGlucHV0RXZlbnQpIHtcblxuICAgICAgICBcdHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgXHQvLyBXZSBuZWVkIHRvIGdldCB0aGUgdG9wIDEyIHBsYXllcnMgZm9yIGV2ZXJ5IGdhbWUuXG4gICAgICAgIFx0dmFyIHBsYXllclBvaW50cyA9IHt9O1xuXG4gICAgICAgIFx0Z2V0R2FtZXNMaXN0KGlucHV0RXZlbnQpLnRoZW4oZnVuY3Rpb24gdGhlbihtb2RlbCkge1xuXG4gICAgICAgIFx0XHR2YXIgZ2FtZXNMaXN0ID0gbW9kZWw7XG4gICAgICAgIFx0XHRnYW1lc0xpc3QuZm9yRWFjaChmdW5jdGlvbihnYW1lKSB7XG5cbiAgICAgICAgXHRcdFx0aWYgKGdhbWUuc2NvcmVzKSB7XG5cbiAgICAgICAgXHRcdFx0XHQvLyBDb252ZXJ0IHRoZSBnYW1lJ3Mgc2NvcmVzIHRvIGFuIGFycmF5LlxuICAgICAgICBcdFx0XHRcdHZhciBzY29yZXNBcnJheSA9ICQubWFwKGdhbWUuc2NvcmVzLCBmdW5jdGlvbihlbCkgeyByZXR1cm4gZWw7IH0pO1xuICAgICAgICBcdFx0XHRcdHNjb3Jlc0FycmF5ID0gJGZpbHRlcignb3JkZXJCeScpKHNjb3Jlc0FycmF5LCAnLXNjb3JlJyk7XG5cbiAgICAgICAgXHRcdFx0XHR2YXIgdG90YWxBd2FyZCA9IDEyO1xuXG4gICAgICAgIFx0XHRcdFx0Ly8gSXRlcmF0ZSB0aHJvdWdoIHRoZSB0b3Agc2NvcmVzIGF3YXJkaW5nIHBvaW50cy5cbiAgICAgICAgXHRcdFx0XHRmb3IgKHZhciBpID0gMDsgaSA8IHNjb3Jlc0FycmF5Lmxlbmd0aDsgaSsrKSB7XG5cbiAgICAgICAgXHRcdFx0XHRcdGlmICghcGxheWVyUG9pbnRzW3Njb3Jlc0FycmF5W2ldLnVzZXJOYW1lXSkge1xuICAgICAgICBcdFx0XHRcdFx0XHRwbGF5ZXJQb2ludHNbc2NvcmVzQXJyYXlbaV0udXNlck5hbWVdID0ge1xuICAgICAgICBcdFx0XHRcdFx0XHRcdHBvaW50czogMFxuICAgICAgICBcdFx0XHRcdFx0XHR9O1xuICAgICAgICBcdFx0XHRcdFx0fVxuXG4gICAgICAgIFx0XHRcdFx0XHRwbGF5ZXJQb2ludHNbc2NvcmVzQXJyYXlbaV0udXNlck5hbWVdLnBvaW50cyArPSB0b3RhbEF3YXJkO1xuXG4gICAgICAgIFx0XHRcdFx0XHRpZiAodG90YWxBd2FyZCA+IDApIHtcbiAgICAgICAgXHRcdFx0XHRcdFx0dG90YWxBd2FyZCAtPSAxO1xuICAgICAgICBcdFx0XHRcdFx0fVxuXG4gICAgICAgIFx0XHRcdFx0fVxuXG4gICAgICAgIFx0XHRcdH1cblxuICAgICAgICBcdFx0fSk7XG5cbiAgICAgICAgXHRcdC8vIEZpbmQgYW5kIHJlc29sdmUgdGllcy5cbiAgICAgICAgXHRcdHBsYXllclBvaW50cyA9ICRmaWx0ZXIoJ29yZGVyT2JqZWN0QnknKShwbGF5ZXJQb2ludHMsICdwb2ludHMnLCB0cnVlKTtcbiAgICAgICAgICAgICAgICB2YXIgaGF2ZUJvdHRvbVNjb3JlcnNGbG9vciA9IGZhbHNlO1xuICAgICAgICAgICAgICAgIHZhciBmbG9vclJhbmdlID0gMDtcbiAgICAgICAgXHRcdGZvciAodmFyIGkgPSAwOyBpIDwgcGxheWVyUG9pbnRzLmxlbmd0aDsgaSArPSAxKSB7XG5cbiAgICAgICAgXHRcdFx0aWYgKHBsYXllclBvaW50c1tpLTFdICYmIHBsYXllclBvaW50c1tpXS5wb2ludHMgJiYgcGxheWVyUG9pbnRzW2ktMV0ucG9pbnRzKSB7XG5cbiAgICAgICAgXHRcdFx0XHRpZiAocGxheWVyUG9pbnRzW2ldLnBvaW50cyA9PT0gcGxheWVyUG9pbnRzW2ktMV0ucG9pbnRzKSB7XG4gICAgICAgIFx0XHRcdFx0XHRwbGF5ZXJQb2ludHNbaV0ucG9zaXRpb24gPSBwbGF5ZXJQb2ludHNbaS0xXS5wb3NpdGlvbjtcbiAgICAgICAgXHRcdFx0XHR9IGVsc2Uge1xuICAgICAgICBcdFx0XHRcdFx0cGxheWVyUG9pbnRzW2ldLnBvc2l0aW9uID0gKGkrMSk7XG4gICAgICAgIFx0XHRcdFx0fVxuXG4gICAgICAgIFx0XHRcdH0gZWxzZSB7XG5cbiAgICAgICAgXHRcdFx0XHRpZiAoaSA9PT0gMCkge1xuICAgICAgICBcdFx0XHRcdFx0cGxheWVyUG9pbnRzW2ldLnBvc2l0aW9uID0gMTtcbiAgICAgICAgXHRcdFx0XHR9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgaWYgKCFoYXZlQm90dG9tU2NvcmVyc0Zsb29yKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIC8vIEdldCBjb3VudCBvZiBwbGF5ZXJzIGluIG9uZSBwb3NpdGlvbiBoaWdoZXIuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHZhciBnZXRTY29yZUNvdW50T2YgPSBwbGF5ZXJQb2ludHNbaS0xXS5wb2ludHM7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaiA9IDA7IGogPCBwbGF5ZXJQb2ludHMubGVuZ3RoOyBqICs9IDEpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmIChwbGF5ZXJQb2ludHNbal0ucG9pbnRzID09PSBnZXRTY29yZUNvdW50T2YpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBmbG9vclJhbmdlICs9IDE7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXZlQm90dG9tU2NvcmVyc0Zsb29yID0gdHJ1ZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgXHRcdFx0XHRcdHBsYXllclBvaW50c1tpXS5wb3NpdGlvbiA9IChwbGF5ZXJQb2ludHMubGVuZ3RoICsgMSkgLSBmbG9vclJhbmdlO1xuICAgICAgICBcdFx0XHRcdH1cblxuICAgICAgICBcdFx0XHR9XG5cbiAgICAgICAgXHRcdH1cblxuICAgICAgICBcdFx0ZGVmZXJyZWQucmVzb2x2ZShwbGF5ZXJQb2ludHMpO1xuXG4gICAgICAgIFx0fSk7XG5cblx0XHRcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRTaW5nbGVHYW1lTGVhZGVyYm9hcmQoaW5wdXRFdmVudCkge1xuXG4gICAgICAgICAgICB2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZJUkVCQVNFREFUQS5GQlVSTCk7XG4gICAgICAgICAgICB2YXIgbGVhZGVyYm9hcmREYXRhID0gJGZpcmViYXNlQXJyYXkoXG4gICAgICAgICAgICAgICAgcmVmXG4gICAgICAgICAgICAgICAgICAgIC5jaGlsZCgnY29udGVzdHMnKVxuICAgICAgICAgICAgICAgICAgICAuY2hpbGQoaW5wdXRFdmVudClcbiAgICAgICAgICAgICAgICAgICAgLmNoaWxkKCdzY29yZXMnKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShsZWFkZXJib2FyZERhdGEpO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0U3VtbWFyaXplZExlYWRlcmJvYXJkT2JqZWN0KCkge1xuICAgICAgICAgICAgcmV0dXJuIF9zdW1tYXJpemVkTGVhZGVyYm9hcmQ7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRUZWFtTGlzdE9iamVjdCgpIHtcbiAgICAgICAgICAgIHJldHVybiBfdGVhbUxpc3Q7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRQbGF5ZXJTY29yZXMoaW5wdXRFdmVudCwgaW5wdXRHYW1lc0xpc3QsIGlucHV0UGxheWVyKSB7XG5cbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG5cbiAgICAgICAgICAgIHZhciBkaXNwbGF5U2NvcmVzID0gW107XG5cbiAgICAgICAgICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCBldmVyeSBnYW1lLlxuICAgICAgICAgICAgaW5wdXRHYW1lc0xpc3QuZm9yRWFjaChmdW5jdGlvbihnYW1lKSB7XG5cbiAgICAgICAgICAgICAgICBpZiAoZ2FtZS5zY29yZXMpIHtcblxuICAgICAgICAgICAgICAgICAgICAvLyBDb252ZXJ0IHRoZSBnYW1lJ3Mgc2NvcmVzIHRvIGFuIGFycmF5LlxuICAgICAgICAgICAgICAgICAgICB2YXIgc2NvcmVzQXJyYXkgPSAkLm1hcChnYW1lLnNjb3JlcywgZnVuY3Rpb24oZWwpIHsgcmV0dXJuIGVsOyB9KTtcbiAgICAgICAgICAgICAgICAgICAgc2NvcmVzQXJyYXkgPSAkZmlsdGVyKCdvcmRlckJ5Jykoc2NvcmVzQXJyYXksICctc2NvcmUnKTtcblxuICAgICAgICAgICAgICAgICAgICB2YXIgdG90YWxBd2FyZCA9IDEyO1xuXG4gICAgICAgICAgICAgICAgICAgIC8vIEl0ZXJhdGUgdGhyb3VnaCB0aGUgc2NvcmVzIHN0YXJ0aW5nIGZyb20gdGhlIHRvcCBhbmQgZmluZCBvdXIgdXNlci5cbiAgICAgICAgICAgICAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzY29yZXNBcnJheS5sZW5ndGg7IGkrKykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAvLyBGb3VuZCBvdXIgcGxheWVyLlxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHNjb3Jlc0FycmF5W2ldLnVzZXJOYW1lID09PSBpbnB1dFBsYXllcikge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdmFyIG5ld1Njb3JlT2JqZWN0ID0gZ2FtZTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdTY29yZU9iamVjdC5wb3NpdGlvbiA9IGkrMTtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdTY29yZU9iamVjdC5zY29yZSA9IHNjb3Jlc0FycmF5W2ldLnNjb3JlO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1Njb3JlT2JqZWN0LnBvaW50c0Vhcm5lZCA9IHRvdGFsQXdhcmQ7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgbmV3U2NvcmVPYmplY3QuaW5wVXJsID0gc2NvcmVzQXJyYXlbaV0uaW5wVXJsID8gc2NvcmVzQXJyYXlbaV0uaW5wVXJsIDogbnVsbDtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBuZXdTY29yZU9iamVjdC50d2l0Y2hVcmwgPSBzY29yZXNBcnJheVtpXS50d2l0Y2hVcmwgPyBzY29yZXNBcnJheVtpXS50d2l0Y2hVcmwgOiBudWxsO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5ld1Njb3JlT2JqZWN0Lm1hbWVWZXJzaW9uID0gc2NvcmVzQXJyYXlbaV0ubWFtZVZlcnNpb24gPyBzY29yZXNBcnJheVtpXS5tYW1lVmVyc2lvbiA6IG51bGw7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBkaXNwbGF5U2NvcmVzLnB1c2gobmV3U2NvcmVPYmplY3QpO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRvdGFsQXdhcmQgPSAxMjtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBicmVhaztcblxuICAgICAgICAgICAgICAgICAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAodG90YWxBd2FyZCA+IDApIHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdG90YWxBd2FyZCAtPSAxO1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBkZWZlcnJlZC5yZXNvbHZlKGRpc3BsYXlTY29yZXMpO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gbG9hZEV2ZW50UHJvcGVydGllcyhpbnB1dEV2ZW50KSB7XG5cbiAgICAgICAgICAgIHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRklSRUJBU0VEQVRBLkZCVVJMKTtcbiAgICAgICAgICAgIHZhciBpbnB1dEV2ZW50UHJvcGVydGllcyA9ICRmaXJlYmFzZU9iamVjdChcbiAgICAgICAgICAgICAgICByZWZcbiAgICAgICAgICAgICAgICAgICAgLmNoaWxkKCdjb250ZXN0cycpXG4gICAgICAgICAgICAgICAgICAgIC5jaGlsZChpbnB1dEV2ZW50KVxuICAgICAgICAgICAgICAgICAgICAuY2hpbGQoJ3Byb3BlcnRpZXMnKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgaW5wdXRFdmVudFByb3BlcnRpZXMuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgX2V2ZW50UHJvcGVydGllcyA9IGlucHV0RXZlbnRQcm9wZXJ0aWVzO1xuXG4gICAgICAgICAgICAgICAgLy8gSWYgdGhpcyBpcyBhIG11bHRpZ2FtZSBldmVudCwgZ2V0IHRoZSBkYXRhIG5lZWRlZCBmb3IgbXVsdGlnYW1lIGNvbXBvbmVudHMuXG4gICAgICAgICAgICAgICAgaWYgKF9ldmVudFByb3BlcnRpZXMuZm9ybWF0Lm11bHRpR2FtZSkge1xuXG4gICAgICAgICAgICAgICAgICAgIGdldEdhbWVzTGlzdChpbnB1dEV2ZW50KS50aGVuKGZ1bmN0aW9uIHRoZW4obW9kZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIF9nYW1lTGlzdCA9IG1vZGVsO1xuICAgICAgICAgICAgICAgICAgICAgICAgZ2V0Rmlyc3RQbGFjZVNjb3JlcygpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgICAgICBnZXRNdWx0aUdhbWVMZWFkZXJib2FyZChpbnB1dEV2ZW50KS50aGVuKGZ1bmN0aW9uIHRoZW4obW9kZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsZWFkZXJib2FyZCA9IG1vZGVsO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2xlYWRlcmJvYXJkTGVuZ3RoID0gbGVhZGVyYm9hcmQubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3N1bW1hcml6ZWRMZWFkZXJib2FyZCA9IGxlYWRlcmJvYXJkLnNsaWNlKDAsIDgpO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIC8vIElmIHRoaXMgaXMgYSBzaW5nbGUgZ2FtZSBldmVudCwgZ2V0IHRoZSBkYXRhIG5lZWRlZCBmb3Igc2luZ2xlIGdhbWUgY29tcG9uZW50cy5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIGdldFNpbmdsZUdhbWVMZWFkZXJib2FyZChpbnB1dEV2ZW50KS50aGVuKGZ1bmN0aW9uIHRoZW4obW9kZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIHZhciBsZWFkZXJib2FyZCA9IG1vZGVsO1xuICAgICAgICAgICAgICAgICAgICAgICAgX2xlYWRlcmJvYXJkTGVuZ3RoID0gbGVhZGVyYm9hcmQubGVuZ3RoO1xuICAgICAgICAgICAgICAgICAgICAgICAgX3N1bW1hcml6ZWRMZWFkZXJib2FyZCA9IGxlYWRlcmJvYXJkO1xuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIC8vIElmIHRoaXMgaXMgYSB0ZWFtLWJhc2VkIGV2ZW50LCBnZXQgdGhlIGRhdGEgbmVlZGVkIGZvciB0ZWFtIGV2ZW50IGNvbXBvbmVudHMuXG4gICAgICAgICAgICAgICAgaWYgKF9ldmVudFByb3BlcnRpZXMuZm9ybWF0LnRlYW1CYXNlZCkge1xuXG4gICAgICAgICAgICAgICAgICAgIHRlYW1TZXJ2aWNlLmdldFRlYW1MaXN0KHZtLmV2ZW50TmFtZSkudGhlbihmdW5jdGlvbiB0aGVuKG1vZGVsKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICBfdGVhbUxpc3QgPSBtb2RlbDtcbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndmcuYXBwJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0V2ZW50TWFpbkNvbnRyb2xsZXInLCBFdmVudE1haW5Db250cm9sbGVyKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEV2ZW50TWFpbkNvbnRyb2xsZXIoJHNjb3BlLCAkZmlsdGVyLCAkc3RhdGVQYXJhbXMsICRzdGF0ZSwgJHRpbWVvdXQsICRmaXJlYmFzZUFycmF5LCBldmVudFNlcnZpY2UsIGF1dGhTZXJ2aWNlLCBwcm9maWxlU2VydmljZSwgdGVhbVNlcnZpY2UsIEZJUkVCQVNFREFUQSkge1xuXG4gICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgICAgICAgdmFyIHZtID0gdGhpcztcblxuICAgICAgICB2bS5ldmVudE5hbWUgPSAkc3RhdGVQYXJhbXMuZXZlbnROYW1lO1xuXG4gICAgICAgIHZtLmNyZWF0ZVRlYW0gPSBjcmVhdGVUZWFtO1xuICAgICAgICB2bS5kZXRlcm1pbmVQb2ludHMgPSBkZXRlcm1pbmVQb2ludHM7XG4gICAgICAgIHZtLmdvVG9QbGF5ZXJQcm9maWxlID0gZ29Ub1BsYXllclByb2ZpbGU7XG4gICAgICAgIHZtLm9wZW5HYW1lTW9kYWwgPSBvcGVuR2FtZU1vZGFsO1xuICAgICAgICB2bS5vcGVuTW9kYWwgPSBvcGVuTW9kYWw7XG4gICAgICAgIHZtLm9wZW5NdWx0aUdhbWVMZWFkZXJib2FyZE1vZGFsID0gb3Blbk11bHRpR2FtZUxlYWRlcmJvYXJkTW9kYWw7XG4gICAgICAgIHZtLm9wZW5QbGF5ZXJNb2RhbCA9IG9wZW5QbGF5ZXJNb2RhbDtcblxuICAgICAgICBpbml0RXZlbnQoKTtcblxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBjbG9zZU1vZGFsKCkge1xuICAgICAgICAgICAgYW5ndWxhci5lbGVtZW50KCcubW9kYWwnKS5jbG9zZU1vZGFsKCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBjcmVhdGVUZWFtKCkge1xuICAgICAgICAgICAgdGVhbVNlcnZpY2UuY3JlYXRlVGVhbSh2bS5ldmVudE5hbWUsIHZtLm5ld1RlYW0pLnRoZW4oZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgTWF0ZXJpYWxpemUudG9hc3QoJ1RlYW0gJyArIHZtLm5ld1RlYW0uc2hvcnROYW1lICsgJyBjcmVhdGVkLicsIDQwMDApO1xuICAgICAgICAgICAgICAgIHZtLm5ld1RlYW0gPSBudWxsO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBkZXRlcm1pbmVQb2ludHMoaW5wdXRTY29yZURhdGEsIGlucHV0SW5kZXgpIHtcblxuICAgICAgICAgICAgdmFyIHVzZXJHYW1lUG9pbnRzO1xuXG4gICAgICAgICAgICAvLyBObyBwb3NpdGlvbiBncmVhdGVyIHRoYW4gMTIgZ2V0cyBwb2ludHMuXG4gICAgICAgICAgICBpZiAoaW5wdXRJbmRleCA+IDExKSB7XG4gICAgICAgICAgICAgICAgdXNlckdhbWVQb2ludHMgPSAwO1xuICAgICAgICAgICAgICAgIHJldHVybiB1c2VyR2FtZVBvaW50cztcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgdXNlckdhbWVQb2ludHMgPSAxMiAtIGlucHV0SW5kZXg7XG5cbiAgICAgICAgICAgIHZhciBzb3J0ZWRTY29yZXMgPSAkZmlsdGVyKCdvcmRlckJ5Jykodm0uZ2FtZVNjb3JlcywgJy1zY29yZScpO1xuXG4gICAgICAgICAgICAvLyBBbSBJIHRpZWQgd2l0aCB0aGUgcGVyc29uIGFib3ZlIG1lPyBJZiBzbywgbWF0Y2ggdGhlaXIgcG9pbnRzLlxuICAgICAgICAgICAgaWYgKHNvcnRlZFNjb3Jlc1tpbnB1dEluZGV4IC0gMV0pIHtcblxuICAgICAgICAgICAgICAgIGlmIChzb3J0ZWRTY29yZXNbaW5wdXRJbmRleCAtIDFdLnNjb3JlID09PSBpbnB1dFNjb3JlRGF0YS5zY29yZSkge1xuICAgICAgICAgICAgICAgICAgICB1c2VyR2FtZVBvaW50cyArPSAxO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgcmV0dXJuIHVzZXJHYW1lUG9pbnRzO1xuXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnb1RvUGxheWVyUHJvZmlsZShpbnB1dFBsYXllcikge1xuXG4gICAgICAgICAgICBjbG9zZU1vZGFsKCk7XG4gICAgICAgICAgICAkc3RhdGUuZ28oJ3Byb2ZpbGUnLCB7dXNlcm5hbWU6IGlucHV0UGxheWVyfSk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGluaXRFdmVudCgpIHtcblxuICAgICAgICAgICAgZXZlbnRTZXJ2aWNlLmxvYWRFdmVudFByb3BlcnRpZXModm0uZXZlbnROYW1lKTtcblxuICAgICAgICAgICAgcHJvZmlsZVNlcnZpY2UuZ2V0QXZhdGFyRGF0YSgpLnRoZW4oZnVuY3Rpb24gdGhlbihtb2RlbCkge1xuICAgICAgICAgICAgICAgIHZtLmF2YXRhckRhdGEgPSBtb2RlbDtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAkc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbigpIHsgcmV0dXJuIGV2ZW50U2VydmljZS5nZXRFdmVudFByb3BlcnRpZXNPYmplY3QoKTsgfSwgZnVuY3Rpb24obW9kZWwpIHtcbiAgICAgICAgICAgICAgICB2bS5ldmVudFByb3BlcnRpZXMgPSBtb2RlbDtcbiAgICAgICAgICAgIH0sIHRydWUpO1xuXG4gICAgICAgICAgICAkc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbigpIHsgcmV0dXJuIGV2ZW50U2VydmljZS5nZXRUZWFtTGlzdE9iamVjdCgpOyB9LCBmdW5jdGlvbihtb2RlbCkge1xuICAgICAgICAgICAgICAgIHZtLnRlYW1MaXN0ID0gbW9kZWw7XG4gICAgICAgICAgICB9LCB0cnVlKTtcblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gb3Blbk1vZGFsKGlucHV0TW9kYWwpIHtcblxuICAgICAgICAgICAgLy8gVGhpcyB3aWxsIGV2YWx1YXRlIHRvIHRydWUgaWYgYSBNYXRlcmlhbGl6ZSBtb2RhbCBpcyBvcGVuLlxuICAgICAgICAgICAgaWYgKGFuZ3VsYXIuZWxlbWVudCgnI2xlYW4tb3ZlcmxheScpLmxlbmd0aCA9PT0gMSkge1xuXG4gICAgICAgICAgICAgICAgY2xvc2VNb2RhbCgpO1xuICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoaW5wdXRNb2RhbCkub3Blbk1vZGFsKCk7XG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChpbnB1dE1vZGFsICsgJ0NvbnRlbnQnKS5zY3JvbGxUb3AoMCk7XG4gICAgICAgICAgICAgICAgfSwgNDUwKTtcblxuICAgICAgICAgICAgfSBlbHNlIHtcblxuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudChpbnB1dE1vZGFsKS5vcGVuTW9kYWwoKTtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoaW5wdXRNb2RhbCArICdDb250ZW50Jykuc2Nyb2xsVG9wKDApO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIG9wZW5HYW1lTW9kYWwoaW5wdXRHYW1lTmFtZSkge1xuXG4gICAgICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZJUkVCQVNFREFUQS5GQlVSTCk7XG5cbiAgICAgICAgICAgIGV2ZW50U2VydmljZS5nZXRHYW1lRGF0YSh2bS5ldmVudE5hbWUsIGlucHV0R2FtZU5hbWUpLnRoZW4oZnVuY3Rpb24gdGhlbihtb2RlbCkge1xuICAgICAgICAgICAgICAgIHZtLmdhbWVEYXRhID0gbW9kZWw7XG5cbiAgICAgICAgICAgICAgICB2bS5nYW1lU2NvcmVzID0gJGZpcmViYXNlQXJyYXkoXG4gICAgICAgICAgICAgICAgICAgIHJlZlxuICAgICAgICAgICAgICAgICAgICAgICAgLmNoaWxkKCdjb250ZXN0cycpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2hpbGQodm0uZXZlbnROYW1lKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNoaWxkKCdhY3RpdmVHYW1lcycpXG4gICAgICAgICAgICAgICAgICAgICAgICAuY2hpbGQodm0uZ2FtZURhdGEuJGlkKVxuICAgICAgICAgICAgICAgICAgICAgICAgLmNoaWxkKCdzY29yZXMnKVxuICAgICAgICAgICAgICAgICk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgb3Blbk1vZGFsKCcjZ2FtZU1vZGFsJyk7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIG9wZW5NdWx0aUdhbWVMZWFkZXJib2FyZE1vZGFsKCkge1xuXG4gICAgICAgICAgICBldmVudFNlcnZpY2UuZ2V0TXVsdGlHYW1lTGVhZGVyYm9hcmQodm0uZXZlbnROYW1lKS50aGVuKGZ1bmN0aW9uIHRoZW4obW9kZWwpIHtcbiAgICAgICAgICAgICAgICB2bS5jb21wbGV0ZUxlYWRlcmJvYXJkID0gbW9kZWw7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgb3Blbk1vZGFsKCcjbXVsdGlHYW1lTGVhZGVyYm9hcmRNb2RhbCcpO1xuXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBvcGVuUGxheWVyTW9kYWwoaW5wdXRQbGF5ZXIpIHtcblxuICAgICAgICAgICAgdm0uZm9jdXNQbGF5ZXIgPSBpbnB1dFBsYXllcjtcblxuICAgICAgICAgICAgZXZlbnRTZXJ2aWNlLmdldFBsYXllclNjb3Jlcyh2bS5ldmVudE5hbWUsIHZtLmdhbWVMaXN0LCB2bS5mb2N1c1BsYXllcikudGhlbihmdW5jdGlvbiB0aGVuKG1vZGVsKSB7XG4gICAgICAgICAgICAgICAgdm0ucGxheWVyU2NvcmVzID0gbW9kZWw7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgb3Blbk1vZGFsKCcjcGxheWVyTW9kYWwnKTtcblxuICAgICAgICB9XG5cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndmcuYXBwJylcbiAgICAgICAgLnNlcnZpY2UoJ3RlYW1TZXJ2aWNlJywgdGVhbVNlcnZpY2UpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gdGVhbVNlcnZpY2UoJHEsICRmaXJlYmFzZUFycmF5LCAkZmlyZWJhc2VPYmplY3QsIEZJUkVCQVNFREFUQSkge1xuXG4gICAgXHR0aGlzLmNyZWF0ZVRlYW0gPSBjcmVhdGVUZWFtO1xuICAgICAgICB0aGlzLmdldFRlYW1MaXN0ID0gZ2V0VGVhbUxpc3Q7XG5cbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGNyZWF0ZVRlYW0oaW5wdXRFdmVudCwgaW5wdXROZXdUZWFtUHJvcGVydGllcykge1xuXG4gICAgICAgIFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcblxuICAgICAgICBcdHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRklSRUJBU0VEQVRBLkZCVVJMKTtcbiAgICAgICAgXHR2YXIgdGVhbVBvb2wgPSAkZmlyZWJhc2VPYmplY3QoXG4gICAgICAgIFx0XHRyZWZcbiAgICAgICAgXHRcdFx0LmNoaWxkKCdjb250ZXN0cycpXG4gICAgICAgIFx0XHRcdC5jaGlsZChpbnB1dEV2ZW50KVxuICAgICAgICBcdFx0XHQuY2hpbGQoJ3RlYW1Qb29sJylcbiAgICAgICAgXHQpO1xuXG4gICAgICAgIFx0dGVhbVBvb2wuJGxvYWRlZCgpLnRoZW4oZnVuY3Rpb24oKSB7XG5cbiAgICAgICAgXHRcdHRlYW1Qb29sW2lucHV0TmV3VGVhbVByb3BlcnRpZXMuc2hvcnROYW1lXSA9IHtcbiAgICAgICAgXHRcdFx0ZnVsbE5hbWU6IGlucHV0TmV3VGVhbVByb3BlcnRpZXMuZm9ybWFsTmFtZVxuICAgICAgICBcdFx0fTtcbiAgICAgICAgXHRcdHRlYW1Qb29sLiRzYXZlKCk7XG4gICAgICAgIFx0XHRkZWZlcnJlZC5yZXNvbHZlKCk7XG5cbiAgICAgICAgXHR9KTtcblxuICAgICAgICBcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRUZWFtTGlzdChpbnB1dEV2ZW50KSB7XG5cbiAgICAgICAgXHR2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuXG4gICAgICAgIFx0dmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGSVJFQkFTRURBVEEuRkJVUkwpO1xuICAgICAgICBcdHZhciB0ZWFtTGlzdCA9ICRmaXJlYmFzZUFycmF5KFxuICAgICAgICBcdFx0cmVmXG4gICAgICAgIFx0XHRcdC5jaGlsZCgnY29udGVzdHMnKVxuICAgICAgICBcdFx0XHQuY2hpbGQoaW5wdXRFdmVudClcbiAgICAgICAgXHRcdFx0LmNoaWxkKCd0ZWFtUG9vbCcpXG4gICAgICAgIFx0KTtcblxuICAgICAgICBcdHRlYW1MaXN0LiRsb2FkZWQoKS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICBcdFx0ZGVmZXJyZWQucmVzb2x2ZSh0ZWFtTGlzdCk7XG4gICAgICAgIFx0fSk7XG5cbiAgICAgICAgXHRyZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcblxuICAgICAgICB9XG4gICAgfVxufSkoKTsiLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCd2Zy5hcHAnKVxuICAgICAgICAuY29udHJvbGxlcignSGVhZGVyQ29udHJvbGxlcicsIEhlYWRlckNvbnRyb2xsZXIpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gSGVhZGVyQ29udHJvbGxlcigkdGltZW91dCwgJHJvb3RTY29wZSwgJHdpbmRvdywgJHN0YXRlLCBhdXRoU2VydmljZSkge1xuXG4gICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgdm0ubG9nT3V0ID0gbG9nT3V0O1xuXG4gICAgICAgIGFjdGl2YXRlKCk7XG5cbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgICAgICAgIC8vIEZJWE1FOiBNYXRlcmlhbGl6ZSBhbmQgQW5ndWxhckpTIGRvIG5vdCBwbGF5IG5pY2VseSB0b2dldGhlci4gSWYgdGhlIGRyb3Bkb3duIGlzXG4gICAgICAgICAgICAvLyAgICAgICAgaW5pdGlhbGl6ZWQgYmVmb3JlIGFsbCBjb250ZW50IGhhcyBiZWVuIHJlbmRlcmVkLCB0aGUgZHJvcGRvd24gd2lsbCBub3QgYWN0dWFsbHkgd29yay5cbiAgICAgICAgICAgIC8vICAgICAgICBUaGlzIGlzIGEgbWVzc3kgaGFjayBmb3IgdGhlIHRpbWUgYmVpbmcsIGJ1dCByZXZpc2l0IHRoaXMgbGF0ZXIuXG4gICAgICAgICAgICAkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgICAgICAgICBhbmd1bGFyLmVsZW1lbnQoJy5kcm9wZG93bi1idXR0b24nKVxuICAgICAgICAgICAgICAgICAgICAuZHJvcGRvd24oe1xuICAgICAgICAgICAgICAgICAgICAgICAgaW5EdXJhdGlvbjogMzAwLFxuICAgICAgICAgICAgICAgICAgICAgICAgb3V0RHVyYXRpb246IDIyNSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0cmFpbl93aWR0aDogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBob3ZlcjogZmFsc2UsXG4gICAgICAgICAgICAgICAgICAgICAgICBndXR0ZXI6IC0xMTQsXG4gICAgICAgICAgICAgICAgICAgICAgICBiZWxvd09yaWdpbjogdHJ1ZVxuICAgICAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH0sIDQwMCk7XG5cbiAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnLmRyb3Bkb3duLWJ1dHRvbicpXG4gICAgICAgICAgICAgICAgICAgIC5kcm9wZG93bih7XG4gICAgICAgICAgICAgICAgICAgICAgICBpbkR1cmF0aW9uOiAzMDAsXG4gICAgICAgICAgICAgICAgICAgICAgICBvdXREdXJhdGlvbjogMjI1LFxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3RyYWluX3dpZHRoOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGhvdmVyOiBmYWxzZSxcbiAgICAgICAgICAgICAgICAgICAgICAgIGd1dHRlcjogLTExNCxcbiAgICAgICAgICAgICAgICAgICAgICAgIGJlbG93T3JpZ2luOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSwgMTAwMCk7XG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBsb2dPdXQoKSB7XG4gICAgICAgICAgICBhdXRoU2VydmljZS5sb2dPdXQoKTtcbiAgICAgICAgICAgICR3aW5kb3cubG9jYXRpb24ucmVsb2FkKCk7XG4gICAgICAgIH1cblxuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndmcuYXBwJylcbiAgICAgICAgLmZpbHRlcignb3JkZXJPYmplY3RCeScsIG9yZGVyT2JqZWN0QnkpO1xuXG4gICAgZnVuY3Rpb24gb3JkZXJPYmplY3RCeSgpIHtcbiAgICAgICAgcmV0dXJuIGZ1bmN0aW9uKGl0ZW1zLCBmaWVsZCwgcmV2ZXJzZSkge1xuICAgICAgICAgICAgdmFyIGZpbHRlcmVkID0gW107XG5cbiAgICAgICAgICAgIGFuZ3VsYXIuZm9yRWFjaChpdGVtcywgZnVuY3Rpb24oaXRlbSwga2V5KSB7XG4gICAgICAgICAgICAgICAgaXRlbS5rZXkgPSBrZXk7XG4gICAgICAgICAgICAgICAgZmlsdGVyZWQucHVzaChpdGVtKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBmaWx0ZXJlZC5zb3J0KGZ1bmN0aW9uIChhLCBiKSB7XG4gICAgICAgICAgICAgICAgcmV0dXJuIChhW2ZpZWxkXSA+IGJbZmllbGRdID8gMSA6IC0xKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICBpZihyZXZlcnNlKSBmaWx0ZXJlZC5yZXZlcnNlKCk7XG5cbiAgICAgICAgICAgIHJldHVybiBmaWx0ZXJlZDtcbiAgICAgICAgfTtcbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndmcuYXBwJylcbiAgICAgICAgLmRpcmVjdGl2ZSgndmdHYW1lc0xpc3QnLCB2Z0dhbWVzTGlzdCk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiB2Z0dhbWVzTGlzdCAoKSB7XG4gICAgICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICAgICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbGxlcjogR2FtZXNMaXN0Q29udHJvbGxlcixcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4vYXBwL2V2ZW50Q29tcG9uZW50cy9nYW1lc0xpc3QuZGlyZWN0aXZlLmh0bScsXG4gICAgICAgICAgICBzY29wZTogZmFsc2UsXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuICAgIH1cblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEdhbWVzTGlzdENvbnRyb2xsZXIoJHNjb3BlLCBldmVudFNlcnZpY2UpIHtcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuICAgIFx0dmFyIHZtID0gdGhpcztcblxuICAgICAgICAkc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbigpIHsgcmV0dXJuIGV2ZW50U2VydmljZS5nZXRHYW1lTGlzdE9iamVjdCgpOyB9LCBmdW5jdGlvbihtb2RlbCkge1xuICAgICAgICAgICAgJHNjb3BlLiRwYXJlbnQuJHBhcmVudC5ldmVudC5nYW1lTGlzdCA9IG1vZGVsO1xuICAgICAgICB9LCB0cnVlKTtcbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3ZnLmFwcCcpXG4gICAgICAgIC5kaXJlY3RpdmUoJ3ZnTXVsdGlHYW1lTGVhZGVyYm9hcmQnLCB2Z011bHRpR2FtZUxlYWRlcmJvYXJkKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIHZnTXVsdGlHYW1lTGVhZGVyYm9hcmQgKCkge1xuICAgICAgICB2YXIgZGlyZWN0aXZlID0ge1xuICAgICAgICAgICAgYmluZFRvQ29udHJvbGxlcjogdHJ1ZSxcbiAgICAgICAgICAgIGNvbnRyb2xsZXI6IE11bHRpR2FtZUxlYWRlcmJvYXJkQ29udHJvbGxlcixcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4vYXBwL2V2ZW50Q29tcG9uZW50cy9tdWx0aUdhbWVMZWFkZXJib2FyZC5kaXJlY3RpdmUuaHRtJyxcbiAgICAgICAgICAgIHNjb3BlOiBmYWxzZSxcbiAgICAgICAgICAgIHRyYW5zY2x1ZGU6IGZhbHNlXG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG4gICAgfVxuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gTXVsdGlHYW1lTGVhZGVyYm9hcmRDb250cm9sbGVyKCRzY29wZSwgZXZlbnRTZXJ2aWNlKSB7XG4gICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgICBcdHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgJHNjb3BlLiR3YXRjaENvbGxlY3Rpb24oZnVuY3Rpb24oKSB7IHJldHVybiBldmVudFNlcnZpY2UuZ2V0TGVhZGVyYm9hcmRMZW5ndGhWYWx1ZSgpOyB9LCBmdW5jdGlvbihtb2RlbCkge1xuICAgICAgICAgICAgJHNjb3BlLiRwYXJlbnQuJHBhcmVudC5ldmVudC5sZWFkZXJib2FyZExlbmd0aCA9IG1vZGVsO1xuICAgICAgICB9LCB0cnVlKTtcblxuICAgICAgICAkc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbigpIHsgcmV0dXJuIGV2ZW50U2VydmljZS5nZXRTdW1tYXJpemVkTGVhZGVyYm9hcmRPYmplY3QoKTsgfSwgZnVuY3Rpb24obW9kZWwpIHtcbiAgICAgICAgICAgICRzY29wZS4kcGFyZW50LiRwYXJlbnQuZXZlbnQuc3VtbWFyaXplZExlYWRlcmJvYXJkID0gbW9kZWw7XG4gICAgICAgIH0sIHRydWUpO1xuICAgIH1cbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndmcuYXBwJylcbiAgICAgICAgLmRpcmVjdGl2ZSgndmdTaW5nbGVHYW1lTGVhZGVyYm9hcmQnLCB2Z1NpbmdsZUdhbWVMZWFkZXJib2FyZCk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiB2Z1NpbmdsZUdhbWVMZWFkZXJib2FyZCAoKSB7XG4gICAgICAgIHZhciBkaXJlY3RpdmUgPSB7XG4gICAgICAgICAgICBiaW5kVG9Db250cm9sbGVyOiB0cnVlLFxuICAgICAgICAgICAgY29udHJvbGxlcjogU2luZ2xlR2FtZUxlYWRlcmJvYXJkQ29udHJvbGxlcixcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4vYXBwL2V2ZW50Q29tcG9uZW50cy9zaW5nbGVHYW1lTGVhZGVyYm9hcmQuZGlyZWN0aXZlLmh0bScsXG4gICAgICAgICAgICBzY29wZTogZmFsc2UsXG4gICAgICAgICAgICB0cmFuc2NsdWRlOiBmYWxzZVxuICAgICAgICB9O1xuICAgICAgICByZXR1cm4gZGlyZWN0aXZlO1xuICAgIH1cblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIFNpbmdsZUdhbWVMZWFkZXJib2FyZENvbnRyb2xsZXIoJHNjb3BlLCBldmVudFNlcnZpY2UpIHtcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuICAgIFx0dmFyIHZtID0gdGhpcztcblxuICAgICAgICAkc2NvcGUuJHdhdGNoQ29sbGVjdGlvbihmdW5jdGlvbigpIHsgcmV0dXJuIGV2ZW50U2VydmljZS5nZXRMZWFkZXJib2FyZExlbmd0aFZhbHVlKCk7IH0sIGZ1bmN0aW9uKG1vZGVsKSB7XG4gICAgICAgICAgICAkc2NvcGUuJHBhcmVudC4kcGFyZW50LmV2ZW50LmxlYWRlcmJvYXJkTGVuZ3RoID0gbW9kZWw7XG4gICAgICAgIH0sIHRydWUpO1xuXG4gICAgICAgICRzY29wZS4kd2F0Y2hDb2xsZWN0aW9uKGZ1bmN0aW9uKCkgeyByZXR1cm4gZXZlbnRTZXJ2aWNlLmdldFN1bW1hcml6ZWRMZWFkZXJib2FyZE9iamVjdCgpOyB9LCBmdW5jdGlvbihtb2RlbCkge1xuICAgICAgICAgICAgJHNjb3BlLiRwYXJlbnQuJHBhcmVudC5ldmVudC5zdW1tYXJpemVkTGVhZGVyYm9hcmQgPSBtb2RlbDtcbiAgICAgICAgfSwgdHJ1ZSk7XG4gICAgfVxufSkoKTsiLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCd2Zy5hcHAnKVxuICAgICAgICAuZGlyZWN0aXZlKCd2Z1N0aWNreU1lc3NhZ2UnLCB2Z1N0aWNreU1lc3NhZ2UpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gdmdTdGlja3lNZXNzYWdlICgpIHtcbiAgICAgICAgdmFyIGRpcmVjdGl2ZSA9IHtcbiAgICAgICAgICAgIGJpbmRUb0NvbnRyb2xsZXI6IHRydWUsXG4gICAgICAgICAgICBjb250cm9sbGVyOiBTdGlja3lNZXNzYWdlQ29udHJvbGxlcixcbiAgICAgICAgICAgIGNvbnRyb2xsZXJBczogJ3ZtJyxcbiAgICAgICAgICAgIHJlc3RyaWN0OiAnRScsXG4gICAgICAgICAgICB0ZW1wbGF0ZVVybDogJy4vYXBwL2V2ZW50Q29tcG9uZW50cy9zdGlja3lNZXNzYWdlLmRpcmVjdGl2ZS5odG0nLFxuICAgICAgICAgICAgc2NvcGU6IHtcbiAgICAgICAgICAgIFx0cHJvcGVydGllczogJz0nXG4gICAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICAgIHJldHVybiBkaXJlY3RpdmU7XG4gICAgfVxuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gU3RpY2t5TWVzc2FnZUNvbnRyb2xsZXIoJHRpbWVvdXQpIHtcbiAgICAgICAgLyoganNoaW50IHZhbGlkdGhpczogdHJ1ZSAqL1xuICAgIFx0dmFyIHZtID0gdGhpcztcbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3ZnLmFwcCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdBdmF0YXJDb250cm9sbGVyJywgQXZhdGFyQ29udHJvbGxlcik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBBdmF0YXJDb250cm9sbGVyKCRyb290U2NvcGUsICRzdGF0ZSwgJHN0YXRlUGFyYW1zLCAkdGltZW91dCwgVXBsb2FkLCBpbWd1ciwgcHJvZmlsZVNlcnZpY2UpIHtcblxuICAgICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIHZtLnVwbG9hZEF2YXRhciA9IHVwbG9hZEF2YXRhcjtcblxuICAgICAgICBhY3RpdmF0ZSgpO1xuXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy9cblxuICAgICAgICBmdW5jdGlvbiBhY3RpdmF0ZSgpIHtcbiAgICAgICAgXHRwcm9maWxlU2VydmljZS5nZXRBdmF0YXJEYXRhKCkudGhlbihmdW5jdGlvbiB0aGVuKG1vZGVsKSB7XG4gICAgICAgICAgICAgICAgdm0uYXZhdGFyRGF0YSA9IG1vZGVsO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIC8vIEZJWE1FOiBUaGlzIG5lZWRzIHRvIGJlIHRyaWdnZXJlZCBieSBhICRyb290U2NvcGUgYnJvYWRjYXN0IG9mIHdoZW4gaXQgcmVjZWl2ZXMgcHJvZmlsZSBkYXRhLlxuICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgcHJvZmlsZVNlcnZpY2UuZ2V0QmFkZ2VzRGF0YSgkcm9vdFNjb3BlLnByb2ZpbGUudXNlck5hbWUpLnRoZW4oZnVuY3Rpb24gdGhlbihtb2RlbCkge1xuICAgICAgICAgICAgICAgICAgICB2bS5iYWRnZXNEYXRhID0gbW9kZWw7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9LCA1MDApO1xuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gdXBsb2FkQXZhdGFyKCkge1xuXG4gICAgICAgIFx0dm0uZGlzYWJsZUJ1dHRvbiA9IHRydWU7XG5cbiAgICAgICAgXHRpbWd1ci5zZXRBUElLZXkoJ0NsaWVudC1JRCBmNTNkNmQ1ODMzYjA3YmMnKTtcbiAgICAgICAgXHRpbWd1ci51cGxvYWQodm0uZmlsZSkudGhlbihmdW5jdGlvbiB0aGVuKG1vZGVsKSB7XG4gICAgICAgIFx0XHRwcm9maWxlU2VydmljZS5zYXZlQXZhdGFyTGluayhtb2RlbFswXS5saW5rLCAkcm9vdFNjb3BlLnByb2ZpbGUudXNlck5hbWUpO1xuICAgICAgICBcdFx0TWF0ZXJpYWxpemUudG9hc3QoJ1lvdXIgYXZhdGFyIHdhcyB1cGxvYWRlZCcsIDQwMDApO1xuXG4gICAgICAgIFx0XHQkdGltZW91dChmdW5jdGlvbigpIHtcbiAgICAgICAgXHRcdFx0JHN0YXRlLmdvKCdob21lJyk7XG4gICAgICAgIFx0XHR9LCAxMDAwKTtcbiAgICAgICAgXHR9KTtcblxuICAgICAgICB9XG5cbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3ZnLmFwcCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdDaGFuZ2VQYXNzd29yZENvbnRyb2xsZXInLCBDaGFuZ2VQYXNzd29yZENvbnRyb2xsZXIpO1xuXG4gICAgLyogQG5nSW5qZWN0ICovXG4gICAgZnVuY3Rpb24gQ2hhbmdlUGFzc3dvcmRDb250cm9sbGVyKCRzY29wZSwgJHRpbWVvdXQsICRzdGF0ZSwgQXV0aFdyYXBwZXIpIHtcblxuICAgICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG4gICAgICAgIFxuICAgICAgICB2bS5zdWJtaXRDaGFuZ2VQYXNzd29yZCA9IHN1Ym1pdENoYW5nZVBhc3N3b3JkO1xuXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIHN1Ym1pdENoYW5nZVBhc3N3b3JkKCkge1xuXG4gICAgICAgICAgICBpZiAoJHNjb3BlLnB3Q2hhbmdlRm9ybS4kdmFsaWQpIHtcblxuICAgICAgICAgICAgICAgIEF1dGhXcmFwcGVyLiRjaGFuZ2VQYXNzd29yZCh7XG4gICAgICAgICAgICAgICAgICAgIGVtYWlsOiBBdXRoV3JhcHBlci4kZ2V0QXV0aCgpLnBhc3N3b3JkLmVtYWlsLFxuICAgICAgICAgICAgICAgICAgICBvbGRQYXNzd29yZDogdm0uaW5wdXRDdXJyZW50UGFzc3dvcmQsXG4gICAgICAgICAgICAgICAgICAgIG5ld1Bhc3N3b3JkOiB2bS5pbnB1dE5ld1Bhc3N3b3JkXG4gICAgICAgICAgICAgICAgfSkudGhlbihmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICBNYXRlcmlhbGl6ZS50b2FzdCgnWW91ciBwYXNzd29yZCB3YXMgY2hhbmdlZC4nLCA0MDAwKTtcbiAgICAgICAgICAgICAgICAgICAgJHRpbWVvdXQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICAgICAkc3RhdGUuZ28oJ2hvbWUnKTtcbiAgICAgICAgICAgICAgICAgICAgfSwgMTAwMCk7XG5cbiAgICAgICAgICAgICAgICB9KS5jYXRjaChmdW5jdGlvbihlcnJvcikge1xuICAgICAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICAgICAgaWYgKGVycm9yLmNvZGUgPT09ICdJTlZBTElEX1BBU1NXT1JEJykge1xuICAgICAgICAgICAgICAgICAgICAgICAgdm0uc2hvd0NoYW5nZVBhc3N3b3JkTWVzc2FnZSA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9XG5cbiAgICAgICAgfVxuXG4gICAgfVxuXG59KSgpOyIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3ZnLmFwcCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdIb21lQ29udHJvbGxlcicsIEhvbWVDb250cm9sbGVyKTtcblxuICAgIC8qIEBuZ0luamVjdCAqL1xuICAgIGZ1bmN0aW9uIEhvbWVDb250cm9sbGVyKCRzY29wZSwgJHRpbWVvdXQpIHtcblxuICAgICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICB9XG5cbn0pKCk7IiwiKGZ1bmN0aW9uKCkge1xuICAgICd1c2Ugc3RyaWN0JztcblxuICAgIGFuZ3VsYXJcbiAgICAgICAgLm1vZHVsZSgndmcuYXBwJylcbiAgICAgICAgLmNvbnRyb2xsZXIoJ0xlYWRlcmJvYXJkQ29udHJvbGxlcicsIExlYWRlcmJvYXJkQ29udHJvbGxlcik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBMZWFkZXJib2FyZENvbnRyb2xsZXIoJHEsICR0aW1lb3V0LCAkZmlyZWJhc2VBcnJheSwgcHJvZmlsZVNlcnZpY2UsIEZJUkVCQVNFREFUQSkge1xuXG4gICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgICBcdHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgYWN0aXZhdGUoKTtcblxuICAgICAgICAvLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG4gICAgICAgICAgICBnZXRQcm9maWxlU2NvcmVzKCkudGhlbihmdW5jdGlvbiB0aGVuKG1vZGVsKSB7XG4gICAgICAgICAgICAgICAgdm0ucHJvZmlsZVNjb3JlRGF0YSA9IG1vZGVsO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHByb2ZpbGVTZXJ2aWNlLmdldEF2YXRhckRhdGEoKS50aGVuKGZ1bmN0aW9uIHRoZW4obW9kZWwpIHtcbiAgICAgICAgICAgICAgICB2bS5hdmF0YXJEYXRhID0gbW9kZWw7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldFByb2ZpbGVTY29yZXMoKSB7XG5cbiAgICAgICAgXHR2YXIgZGVmZXJyZWQgPSAkcS5kZWZlcigpO1xuICAgICAgICBcdHZhciByZWYgPSBuZXcgRmlyZWJhc2UoRklSRUJBU0VEQVRBLkZCVVJMKTtcblxuICAgICAgICBcdHZhciBwcm9maWxlU2NvcmVEYXRhID0gJGZpcmViYXNlQXJyYXkoXG4gICAgICAgIFx0XHRyZWZcbiAgICAgICAgXHRcdFx0LmNoaWxkKCdiYWRnZXMnKVxuICAgICAgICBcdCk7XG5cbiAgICAgICAgXHRwcm9maWxlU2NvcmVEYXRhLiRsb2FkZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgIFx0XHRkZWZlcnJlZC5yZXNvbHZlKHByb2ZpbGVTY29yZURhdGEpO1xuICAgICAgICBcdH0pO1xuXG4gICAgICAgIFx0cmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG5cbiAgICAgICAgfVxuXG4gICAgfVxufSkoKTsiLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCd2Zy5hcHAnKVxuICAgICAgICAuY29udHJvbGxlcignUHJvZmlsZUNvbnRyb2xsZXInLCBQcm9maWxlQ29udHJvbGxlcik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBQcm9maWxlQ29udHJvbGxlcigkc2NvcGUsICRzdGF0ZVBhcmFtcywgJHEsICR0aW1lb3V0LCAkc3RhdGUsICRmaXJlYmFzZUFycmF5LCBhdXRoU2VydmljZSwgcHJvZmlsZVNlcnZpY2UsIGV2ZW50U2VydmljZSkge1xuXG4gICAgICAgIC8qIGpzaGludCB2YWxpZHRoaXM6IHRydWUgKi9cbiAgICAgICAgdmFyIHZtID0gdGhpcztcbiAgICAgICAgXG4gICAgICAgIGFjdGl2YXRlKCk7XG5cbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXG5cbiAgICAgICAgZnVuY3Rpb24gYWN0aXZhdGUoKSB7XG5cbiAgICAgICAgICAgIHByb2ZpbGVTZXJ2aWNlLmdldFVzZXJEYXRhKCRzdGF0ZVBhcmFtcy51c2VybmFtZSkudGhlbihmdW5jdGlvbiB0aGVuKG1vZGVsKSB7XG4gICAgICAgICAgICAgICAgdm0ucHJvZmlsZURhdGEgPSBtb2RlbDtcblxuICAgICAgICAgICAgICAgIHByb2ZpbGVTZXJ2aWNlLmdldFRvdXJuYW1lbnRIaXN0b3J5KHZtLnByb2ZpbGVEYXRhKS50aGVuKGZ1bmN0aW9uIHRoZW4obW9kZWwpIHtcbiAgICAgICAgICAgICAgICAgICAgdmFyIHRvdXJuYW1lbnRIaXN0b3J5RGF0YSA9IG1vZGVsO1xuICAgICAgICAgICAgICAgICAgICB2bS5ldmVudFN0YW5kaW5ncyA9IHByb2ZpbGVTZXJ2aWNlLmdldFRvdXJuYW1lbnRTdGFuZGluZ3ModG91cm5hbWVudEhpc3RvcnlEYXRhLCAkc3RhdGVQYXJhbXMudXNlcm5hbWUpO1xuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgIHByb2ZpbGVTZXJ2aWNlLmdldEF2YXRhckRhdGEoKS50aGVuKGZ1bmN0aW9uIHRoZW4obW9kZWwpIHtcbiAgICAgICAgICAgICAgICB2bS5hdmF0YXJEYXRhID0gbW9kZWw7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcHJvZmlsZVNlcnZpY2UuZ2V0QmFkZ2VzRGF0YSgkc3RhdGVQYXJhbXMudXNlcm5hbWUpLnRoZW4oZnVuY3Rpb24gdGhlbihtb2RlbCkge1xuICAgICAgICAgICAgICAgIHZtLmJhZGdlc0RhdGEgPSBtb2RlbDtcblxuICAgICAgICAgICAgICAgICR0aW1lb3V0KGZ1bmN0aW9uKCkge1xuXG4gICAgICAgICAgICAgICAgICAgIGFuZ3VsYXIuZWxlbWVudCgnLmNvbGxhcHNpYmxlJykuY29sbGFwc2libGUoe1xuICAgICAgICAgICAgICAgICAgICAgICAgYWNjb3JkaW9uOiB0cnVlXG4gICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgfSwgMjAwKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTsiLCIoZnVuY3Rpb24oKSB7XG4gICAgJ3VzZSBzdHJpY3QnO1xuXG4gICAgYW5ndWxhclxuICAgICAgICAubW9kdWxlKCd2Zy5hcHAnKVxuICAgICAgICAuc2VydmljZSgncHJvZmlsZVNlcnZpY2UnLCBwcm9maWxlU2VydmljZSk7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBwcm9maWxlU2VydmljZSgkcm9vdFNjb3BlLCAkcSwgJGZpcmViYXNlQXJyYXksICRmaXJlYmFzZU9iamVjdCwgZXZlbnRTZXJ2aWNlLCBGSVJFQkFTRURBVEEpIHtcblxuICAgIFx0dGhpcy5nZXRBdmF0YXJEYXRhID0gZ2V0QXZhdGFyRGF0YTtcbiAgICAgICAgdGhpcy5nZXRCYWRnZXNEYXRhID0gZ2V0QmFkZ2VzRGF0YTtcbiAgICBcdHRoaXMuZ2V0VG91cm5hbWVudEhpc3RvcnkgPSBnZXRUb3VybmFtZW50SGlzdG9yeTtcbiAgICAgICAgdGhpcy5nZXRUb3VybmFtZW50U3RhbmRpbmdzID0gZ2V0VG91cm5hbWVudFN0YW5kaW5ncztcbiAgICAgICAgdGhpcy5nZXRVc2VyRGF0YSA9IGdldFVzZXJEYXRhO1xuICAgICAgICB0aGlzLnNhdmVBdmF0YXJMaW5rID0gc2F2ZUF2YXRhckxpbms7XG5cbiAgICAgICAgLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGdldEF2YXRhckRhdGEoKSB7XG5cbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZJUkVCQVNFREFUQS5GQlVSTCk7XG5cbiAgICAgICAgICAgIHZhciBhdmF0YXJEYXRhID0gJGZpcmViYXNlT2JqZWN0KFxuICAgICAgICAgICAgICAgIHJlZlxuICAgICAgICAgICAgICAgICAgICAuY2hpbGQoJ2F2YXRhcnMnKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgYXZhdGFyRGF0YS4kbG9hZGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGRlZmVycmVkLnJlc29sdmUoYXZhdGFyRGF0YSk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGRlZmVycmVkLnByb21pc2U7XG5cbiAgICAgICAgfVxuXG4gICAgICAgIGZ1bmN0aW9uIGdldEJhZGdlc0RhdGEoaW5wdXRVc2VyKSB7XG5cbiAgICAgICAgICAgIHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZJUkVCQVNFREFUQS5GQlVSTCk7XG5cbiAgICAgICAgICAgIHZhciBiYWRnZXNEYXRhID0gJGZpcmViYXNlT2JqZWN0KFxuICAgICAgICAgICAgICAgIHJlZlxuICAgICAgICAgICAgICAgICAgICAuY2hpbGQoJ2JhZGdlcycpXG4gICAgICAgICAgICAgICAgICAgIC5jaGlsZChpbnB1dFVzZXIpXG4gICAgICAgICAgICApO1xuXG4gICAgICAgICAgICBiYWRnZXNEYXRhLiRsb2FkZWQoZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgZGVmZXJyZWQucmVzb2x2ZShiYWRnZXNEYXRhKTtcbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICByZXR1cm4gZGVmZXJyZWQucHJvbWlzZTtcblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gZ2V0VG91cm5hbWVudEhpc3RvcnkoaW5wdXRVc2VyRGF0YSkge1xuXG4gICAgICAgIFx0dmFyIGRlZmVycmVkID0gJHEuZGVmZXIoKTtcbiAgICAgICAgXHR2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZJUkVCQVNFREFUQS5GQlVSTCk7XG5cbiAgICAgICAgXHQvLyBMb29wIHRocm91Z2ggZWFjaCBldmVudCBpbiB0aGUgcGxlZGdlZFRvIG9iamVjdC5cbiAgICAgICAgXHR2YXIgZXZlbnRzQXJyYXkgPSBbXTtcbiAgICAgICAgXHRmb3IgKHZhciBrZXkgaW4gaW5wdXRVc2VyRGF0YS5wbGVkZ2VkVG8pIHtcbiAgICAgICAgXHRcdGV2ZW50c0FycmF5LnB1c2goa2V5KTtcbiAgICAgICAgXHR9XG5cbiAgICAgICAgXHRkZWZlcnJlZC5yZXNvbHZlKGV2ZW50c0FycmF5KTtcblxuICAgICAgICBcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRUb3VybmFtZW50U3RhbmRpbmdzKGlucHV0VG91cm5hbWVudEhpc3RvcnksIGlucHV0VXNlcikge1xuXG4gICAgICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZJUkVCQVNFREFUQS5GQlVSTCk7XG5cbiAgICAgICAgICAgIC8vIExvb3AgdGhyb3VnaCBlYWNoIGV2ZW50IGluIHRoZSB1c2VyJ3MgaGlzdG9yeS5cbiAgICAgICAgICAgIHZhciBldmVudFN0YW5kaW5ncyA9IFtdO1xuICAgICAgICAgICAgaW5wdXRUb3VybmFtZW50SGlzdG9yeS5mb3JFYWNoKGZ1bmN0aW9uKGV2ZW50KSB7XG5cbiAgICAgICAgICAgICAgICBldmVudFNlcnZpY2UuZ2V0RXZlbnRQcm9wZXJ0aWVzKGV2ZW50KS50aGVuKGZ1bmN0aW9uKGV2ZW50UHJvcGVydGllcykge1xuXG4gICAgICAgICAgICAgICAgICAgIGV2ZW50UHJvcGVydGllcy4kbG9hZGVkKCkudGhlbihmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgLy8gSWYgY29uY2x1ZGVkLCBnZXQgdGhlIHVzZXIncyBzdGFuZGluZy5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChldmVudFByb3BlcnRpZXMuc3RhdGUgPT09ICdjb25jbHVkZWQnKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB2YXIgZXZlbnRTdGFuZGluZ0RhdGEgPSAkZmlyZWJhc2VPYmplY3QoXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHJlZlxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNoaWxkKCdzdGFuZGluZ3MnKVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgLmNoaWxkKGV2ZW50KVxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudFN0YW5kaW5nRGF0YS4kbG9hZGVkKCkudGhlbihmdW5jdGlvbigpIHtcblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBpZiAoZXZlbnRTdGFuZGluZ0RhdGFbaW5wdXRVc2VyXSkge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBldmVudFN0YW5kaW5ncy5wdXNoKHtcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBuYW1lOiBldmVudFByb3BlcnRpZXMubmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVtaWVyOiBldmVudFByb3BlcnRpZXMucHJlbWllciA/IHRydWUgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHNob3J0TmFtZTogZXZlbnQsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RhdGU6ICdjb25jbHVkZWQnLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGNvbG9yOiBldmVudFByb3BlcnRpZXMuY29sb3IsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcG9zaXRpb246IGV2ZW50U3RhbmRpbmdEYXRhW2lucHV0VXNlcl1cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0gZWxzZSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIGV2ZW50U3RhbmRpbmdzLnB1c2goe1xuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGV2ZW50UHJvcGVydGllcy5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIHByZW1pZXI6IGV2ZW50UHJvcGVydGllcy5wcmVtaWVyID8gdHJ1ZSA6IG51bGwsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgc2hvcnROYW1lOiBldmVudCxcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZTogJ2NvbmNsdWRlZCcsXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgY29sb3I6IGV2ZW50UHJvcGVydGllcy5jb2xvcixcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogLTFcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKGV2ZW50UHJvcGVydGllcy5zdGF0ZSA9PT0gJ2lucHJvZ3Jlc3MnIHx8IGV2ZW50UHJvcGVydGllcy5zdGF0ZSA9PT0gJ3VwY29taW5nJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgZXZlbnRTdGFuZGluZ3MucHVzaCh7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIG5hbWU6IGV2ZW50UHJvcGVydGllcy5uYW1lLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBwcmVtaWVyOiBldmVudFByb3BlcnRpZXMucHJlbWllciA/IHRydWUgOiBudWxsLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzaG9ydE5hbWU6IGV2ZW50LFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb2xvcjogZXZlbnRQcm9wZXJ0aWVzLmNvbG9yLFxuICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBzdGF0ZTogZXZlbnRQcm9wZXJ0aWVzLnN0YXRlXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgICAgIH0pO1xuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgcmV0dXJuIGV2ZW50U3RhbmRpbmdzO1xuXG4gICAgICAgIH1cblxuICAgICAgICBmdW5jdGlvbiBnZXRVc2VyRGF0YShpbnB1dFVzZXIpIHtcblxuICAgICAgICBcdHZhciBkZWZlcnJlZCA9ICRxLmRlZmVyKCk7XG4gICAgICAgIFx0dmFyIHJlZiA9IG5ldyBGaXJlYmFzZShGSVJFQkFTRURBVEEuRkJVUkwpO1xuXG4gICAgICAgIFx0dmFyIHVzZXJzRGF0YSA9ICRmaXJlYmFzZUFycmF5KFxuICAgICAgICBcdFx0cmVmXG4gICAgICAgIFx0XHRcdC5jaGlsZCgndXNlcnMnKVxuICAgICAgICBcdCk7XG5cbiAgICAgICAgXHR1c2Vyc0RhdGEuJGxvYWRlZChmdW5jdGlvbigpIHtcblxuICAgICAgICBcdFx0dXNlcnNEYXRhLmZvckVhY2goZnVuY3Rpb24odXNlcikge1xuICAgICAgICBcdFx0XHRpZiAodXNlci51c2VyTmFtZSA9PT0gaW5wdXRVc2VyKSB7XG4gICAgICAgIFx0XHRcdFx0ZGVmZXJyZWQucmVzb2x2ZSh1c2VyKTtcbiAgICAgICAgXHRcdFx0fVxuICAgICAgICBcdFx0fSk7XG5cbiAgICAgICAgXHR9KTtcblxuICAgICAgICBcdHJldHVybiBkZWZlcnJlZC5wcm9taXNlO1xuXG4gICAgICAgIH1cblxuICAgICAgICAvLyBGSVhNRTogTWFrZSB0aGlzIHNlcnZlci1zaWRlLlxuICAgICAgICBmdW5jdGlvbiBzYXZlQXZhdGFyTGluayhpbnB1dExpbmssIGlucHV0VXNlcikge1xuICAgICAgICAgICAgXG4gICAgICAgICAgICB2YXIgcmVmID0gbmV3IEZpcmViYXNlKEZJUkVCQVNFREFUQS5GQlVSTCk7XG5cbiAgICAgICAgICAgIHZhciBhdmF0YXJEYXRhID0gJGZpcmViYXNlT2JqZWN0KFxuICAgICAgICAgICAgICAgIHJlZlxuICAgICAgICAgICAgICAgICAgICAuY2hpbGQoJ2F2YXRhcnMnKVxuICAgICAgICAgICAgKTtcblxuICAgICAgICAgICAgYXZhdGFyRGF0YS4kbG9hZGVkKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIGF2YXRhckRhdGFbaW5wdXRVc2VyXSA9IGlucHV0TGluaztcbiAgICAgICAgICAgICAgICBhdmF0YXJEYXRhLiRzYXZlKCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cbiAgICB9XG59KSgpOyIsIihmdW5jdGlvbigpIHtcbiAgICAndXNlIHN0cmljdCc7XG5cbiAgICBhbmd1bGFyXG4gICAgICAgIC5tb2R1bGUoJ3ZnLmFwcCcpXG4gICAgICAgIC5jb250cm9sbGVyKCdSZWdDb250cm9sbGVyJywgUmVnQ29udHJvbGxlcik7XG5cbiAgICAvKiBAbmdJbmplY3QgKi9cbiAgICBmdW5jdGlvbiBSZWdDb250cm9sbGVyKCRzY29wZSwgJHJvb3RTY29wZSwgJHRpbWVvdXQsICR3aW5kb3csICRzdGF0ZSwgJGZpcmViYXNlT2JqZWN0LCBhdXRoU2VydmljZSwgQXV0aFdyYXBwZXIpIHtcblxuICAgICAgICAvKiBqc2hpbnQgdmFsaWR0aGlzOiB0cnVlICovXG4gICAgICAgIHZhciB2bSA9IHRoaXM7XG5cbiAgICAgICAgdm0ubG9naW5Ub0FjY291bnQgPSBsb2dpblRvQWNjb3VudDtcbiAgICAgICAgdm0ucGFzc3dvcmRSZXNldCA9IHBhc3N3b3JkUmVzZXQ7XG4gICAgICAgIHZtLnN1Ym1pdE5ld0FjY291bnQgPSBzdWJtaXROZXdBY2NvdW50O1xuXG4gICAgICAgIC8vLy8vLy8vLy8vLy8vLy8vLy8vL1xuXG4gICAgICAgIGZ1bmN0aW9uIGxvZ2luVG9BY2NvdW50KCkge1xuXG4gICAgICAgICAgICBhdXRoU2VydmljZS5sb2dpblRvQWNjb3VudCh2bS5sb2dpbkVtYWlsLCB2bS5sb2dpblBhc3N3b3JkKS50aGVuKGZ1bmN0aW9uIHRoZW4obW9kZWwpIHtcblxuICAgICAgICAgICAgICAgIHZtLnNob3dJbnZhbGlkVXNlckVycm9yID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgdm0uc2hvd0ludmFsaWRQYXNzd29yZEVycm9yID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBpZiAobW9kZWwgPT09ICdMT0dJTl9TVUNDRVNTJykge1xuXG4gICAgICAgICAgICAgICAgICAgICRzdGF0ZS5nbygnaG9tZScpO1xuXG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtb2RlbCA9PT0gJ0lOVkFMSURfVVNFUicpIHtcbiAgICAgICAgICAgICAgICAgICAgdm0uc2hvd0ludmFsaWRVc2VyRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG4gICAgICAgICAgICAgICAgfSBlbHNlIGlmIChtb2RlbCA9PT0gJ0lOVkFMSURfUEFTU1dPUkQnKSB7XG4gICAgICAgICAgICAgICAgICAgIHZtLnNob3dJbnZhbGlkUGFzc3dvcmRFcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gcGFzc3dvcmRSZXNldCgpIHtcblxuICAgICAgICAgICAgaWYgKCF2bS5sb2dpbkVtYWlsKSB7XG4gICAgICAgICAgICAgICAgdm0uc2hvd1Bhc3N3b3JkUmVzZXRFbWFpbE1lc3NhZ2UgPSB0cnVlO1xuICAgICAgICAgICAgICAgIHJldHVybjtcbiAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgQXV0aFdyYXBwZXIuJHJlc2V0UGFzc3dvcmQoe1xuICAgICAgICAgICAgICAgIGVtYWlsOiB2bS5sb2dpbkVtYWlsXG4gICAgICAgICAgICB9KS50aGVuKGZ1bmN0aW9uKCkge1xuICAgICAgICAgICAgICAgIHZtLnNob3dQYXNzd29yZFJlc2V0RW1haWxNZXNzYWdlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgTWF0ZXJpYWxpemUudG9hc3QoJ0EgcGFzc3dvcmQgcmVzZXQgZW1haWwgaGFzIGJlZW4gc2VudCB0byAnICsgdm0ubG9naW5FbWFpbCArICcuJywgNDAwMCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICB9XG5cbiAgICAgICAgZnVuY3Rpb24gc3VibWl0TmV3QWNjb3VudCgpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gRG9lcyB0aGUgdXNlciBleGlzdD8gSWYgc28sIHNob3cgYW4gZXJyb3IgbWVzc2FnZS5cbiAgICAgICAgICAgIGF1dGhTZXJ2aWNlLmNoZWNrSWZVc2VyRXhpc3RzKHZtLm5ld1VzZXJuYW1lKS50aGVuKGZ1bmN0aW9uKHVzZXJFeGlzdHMpIHtcblxuICAgICAgICAgICAgICAgIHZtLnNob3dEdXBsaWNhdGVVc2VyRXJyb3IgPSBmYWxzZTtcbiAgICAgICAgICAgICAgICB2bS5zaG93RW1haWxUYWtlbkVycm9yID0gZmFsc2U7XG5cbiAgICAgICAgICAgICAgICBpZiAodXNlckV4aXN0cykge1xuXG4gICAgICAgICAgICAgICAgICAgIHZtLnNob3dEdXBsaWNhdGVVc2VyRXJyb3IgPSB0cnVlO1xuICAgICAgICAgICAgICAgICAgICByZXR1cm47XG5cbiAgICAgICAgICAgICAgICAvLyBUcnkgdG8gY3JlYXRlIHRoZSBuZXcgdXNlci5cbiAgICAgICAgICAgICAgICB9IGVsc2Uge1xuXG4gICAgICAgICAgICAgICAgICAgIGF1dGhTZXJ2aWNlLmNyZWF0ZU5ld1VzZXIodm0ubmV3RW1haWwsIHZtLm5ld1Bhc3N3b3JkLCB2bS5uZXdVc2VybmFtZSkudGhlbihmdW5jdGlvbiB0aGVuKG1vZGVsKSB7XG5cbiAgICAgICAgICAgICAgICAgICAgICAgIGlmIChtb2RlbCA9PT0gJ0VNQUlMX1RBS0VOJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdm0uc2hvd0VtYWlsVGFrZW5FcnJvciA9IHRydWU7XG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgcmV0dXJuO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9IGVsc2UgaWYgKG1vZGVsID09PSAnQUNDT1VOVF9DUkVBVEVEJykge1xuXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgJHN0YXRlLmdvKCdwcm9maWxlJywge3VzZXJuYW1lOiB2bS5uZXdVc2VybmFtZX0pO1xuXG4gICAgICAgICAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICAgICAgfSk7XG5cbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIH0pO1xuXG4gICAgICAgIH1cblxuICAgIH1cblxufSkoKTsiXSwic291cmNlUm9vdCI6Ii9zb3VyY2UvIn0=