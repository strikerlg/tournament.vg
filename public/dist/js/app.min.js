!function(){"use strict";angular.module("vg.app",["ngAnimate","ui.router","firebase","validation.match","ordinal","ngFileUpload","ngImgur"])}(),function(){"use strict";function e(e,t){t.otherwise("/"),e.state("home",{url:"/",templateUrl:"app/home/home.htm",controller:"HomeController as home"}).state("registerOrLogin",{url:"/registerOrLogin",templateUrl:"/app/home/reg.htm",controller:"RegController as reg"}).state("profile",{url:"/profile/:username",templateUrl:"/app/home/profile.htm",controller:"ProfileController as profile"}).state("leaderboard",{url:"/leaderboard",templateUrl:"/app/home/leaderboard.htm",controller:"LeaderboardController as leaderboard"}).state("event",{url:"/event/:eventName/main",templateUrl:"/app/event/main.htm",controller:"EventMainController as event"}).state("customizeAvatar",{url:"/customizeAvatar",templateUrl:"/app/home/avatar.htm",controller:"AvatarController as avatar",resolve:{currentAuth:["AuthWrapper",function(e){return e.$requireAuth()}]}}).state("changePassword",{url:"/changePassword",templateUrl:"/app/home/changePassword.htm",controller:"ChangePasswordController as pwchange",resolve:{currentAuth:["AuthWrapper",function(e){return e.$requireAuth()}]}})}angular.module("vg.app").constant("FIREBASEDATA",{FBURL:"https://wolfscontests.firebaseio.com"}).config(e),e.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){"use strict";function e(e,t,r,n,o,a){e.$on("$stateChangeError",function(e,t,n,o,a,i){"AUTH_REQUIRED"===i&&r.go("registerOrLogin")}),e.$on("$stateChangeSuccess",function(){if(o.$getAuth()){var t=o.$getAuth(),r=new Firebase(a.FBURL),i=n(r.child("users").child(t.uid));i.$bindTo(e,"profile").then(function(t){e.unbindFunction=t})}}),e.Utils={keys:Object.keys}}angular.module("vg.app").run(e),e.$inject=["$rootScope","$location","$state","$firebaseObject","AuthWrapper","FIREBASEDATA"]}(),function(){"use strict";function e(e,t,r,n,o,a,i,s){function c(t){var r=e.defer(),a=!1,i=new n.Firebase(s.FBURL+"/users");return i.once("value",function(e){o(function(){e.forEach(function(e){e.val().userName===t&&(a=!0)}),r.resolve(a)})}),r.promise}function l(t,r,n){var o=e.defer();return i.$createUser({email:t,password:r}).then(function(e){new Firebase(s.FBURL).child("users/"+e.uid).set({userName:n,role:"User"},function(e){return console.error(e),e.code}),new Firebase(s.FBURL).child("avatars").child(n).set("http://api.adorable.io/avatars/42/"+n),i.$authWithPassword({email:t,password:r}).then(function(){o.resolve("ACCOUNT_CREATED")})})["catch"](function(e){console.error(e),"EMAIL_TAKEN"===e.code&&o.resolve(e.code)}),o.promise}function u(t,r){var n=e.defer();return i.$authWithPassword({email:t,password:r}).then(function(e){n.resolve("LOGIN_SUCCESS")})["catch"](function(e){"INVALID_USER"===e.code?n.resolve("INVALID_USER"):"INVALID_PASSWORD"===e.code&&n.resolve("INVALID_PASSWORD")}),n.promise}function m(){i.$unauth(),t.unbindFunction()}this.testData="hello world!",this.checkIfUserExists=c,this.createNewUser=l,this.loginToAccount=u,this.logOut=m}angular.module("vg.app").service("authService",e),e.$inject=["$q","$rootScope","$state","$window","$timeout","$firebaseObject","AuthWrapper","FIREBASEDATA"]}(),function(){"use strict";function e(e,t){var r=new Firebase(t.FBURL);return e(r)}angular.module("vg.app").factory("AuthWrapper",e),e.$inject=["$firebaseAuth","FIREBASEDATA"]}(),function(){"use strict";function e(e,t,r,n,o,a,i){function s(t,r,n,o){return e(function(e,t){var a={name:r,mameSet:n,rules:o};R.$add(a),e()})}function c(e){v(e).then(function(t){var r=new Firebase(a.FBURL),o=n(r.child("standings").child(e));o.$loaded().then(function(){t.forEach(function(e){o[e.key]=e.position}),o.$save()})})}function l(t){var r=e.defer(),o=new Firebase(a.FBURL),i=n(o.child("contests").child(t).child("properties"));return r.resolve(i),r.promise}function u(){return C}function m(){R.forEach(function(e){if(e.scores){var r=$.map(e.scores,function(e){return e});r=t("orderBy")(r,"-score"),e.firstScore=r[0]}})}function d(t,r){{var n=e.defer();new Firebase(a.FBURL)}return p(t).then(function(e){e.forEach(function(e){e.name===r&&n.resolve(e)})}),n.promise}function f(){return R}function p(t){var r=e.defer(),n=new Firebase(a.FBURL);return R=o(n.child("contests").child(t).child("activeGames")),R.$loaded().then(function(){m(),R.$watch(function(e){m()}),r.resolve(R)}),r.promise}function h(){return D}function v(r){var n=e.defer(),o={};return p(r).then(function(e){var r=e;r.forEach(function(e){if(e.scores){var r=$.map(e.scores,function(e){return e});r=t("orderBy")(r,"-score");for(var n=12,a=0;a<r.length;a++)o[r[a].userName]||(o[r[a].userName]={points:0}),o[r[a].userName].points+=n,n>0&&(n-=1)}}),o=t("orderObjectBy")(o,"points",!0);for(var a=!1,i=0,s=0;s<o.length;s+=1)if(o[s-1]&&o[s].points&&o[s-1].points)o[s].position=o[s].points===o[s-1].points?o[s-1].position:s+1;else if(0===s)o[s].position=1;else{if(!a){for(var c=o[s-1].points,l=0;l<o.length;l+=1)o[l].points===c&&(i+=1);a=!0}o[s].position=o.length+1-i}n.resolve(o)}),n.promise}function g(t){var r=e.defer(),n=new Firebase(a.FBURL),i=o(n.child("contests").child(t).child("scores"));return r.resolve(i),r.promise}function b(){return j}function w(r){return e(function(e,r){var n={};R.forEach(function(e){if(e.scores){var r=$.map(e.scores,function(e){return e});r=t("orderBy")(r,"-score");for(var o=5*O.length,a={},i=0;i<r.length;i++)a[r[i].team]?a[r[i].team]+=1:a[r[i].team]=1,n[r[i].userName]||(n[r[i].userName]={points:0}),a[r[i].team]<=5&&(n[r[i].userName].points+=o,n[r[i].userName].team=r[i].team,o>0&&(o-=1))}}),n=t("orderObjectBy")(n,"points",!0),e(n)})}function L(r,n){return e(function(e,r){var o={},a=[];R.forEach(function(e){if(e.scores){var r=$.map(e.scores,function(e){return e});r=t("orderBy")(r,"-score");for(var i=5*O.length,s={},c=0;c<r.length;c++)s[r[c].team]?s[r[c].team]+=1:s[r[c].team]=1,o[r[c].team]||(o[r[c].team]={points:0}),s[r[c].team]<=5&&(o[r[c].team].points+=i,i>0&&(i-=1));a.push({name:e.name,camelName:e.camelName,points:o[n]&&o[n].points?o[n].points:0}),o[n]&&o[n].points&&(o[n].points=0)}}),o=t("orderObjectBy")(o,"points",!0),e(a)})}function S(r){return e(function(e,r){var n={};R.forEach(function(e){if(e.scores){var r=$.map(e.scores,function(e){return e});r=t("orderBy")(r,"-score");for(var o=5*O.length,a={},i=0;i<r.length;i++)a[r[i].team]?a[r[i].team]+=1:a[r[i].team]=1,n[r[i].team]||(n[r[i].team]={points:0}),a[r[i].team]<=5&&(n[r[i].team].points+=o,o>0&&(o-=1))}}),n=t("orderObjectBy")(n,"points",!0),n.forEach(function(e){O.forEach(function(t){e.key===t.$id&&(e.fullName=t.fullName)})}),e(n)})}function A(){return O}function E(t){var r=e.defer(),o=new Firebase(a.FBURL),i=n(o.child("contests").child(t).child("playerPool"));return r.resolve(i),r.promise}function U(r,n,o){return e(function(e,r){var a=[],i={};n.forEach(function(e){if(e.scores){var r=$.map(e.scores,function(e){return e});r=t("orderBy")(r,"-score");for(var n=5*O.length,s={},c=0;c<r.length;c++)if(s[r[c].team]?s[r[c].team]+=1:s[r[c].team]=1,i[r[c].userName]||(i[r[c].userName]={points:0}),r[c].userName===o){var l={};l.position=c+1,l.name=e.name,l.team=r[c].team,l.score=r[c].score,l.inpUrl=r[c].inpUrl?r[c].inpUrl:null,l.twitchUrl=r[c].twitchUrl?r[c].twitchUrl:null,l.screenshotUrl=r[c].screenshotUrl?r[c].screenshotUrl:null,l.mameVersion=r[c].mameVersion?r[c].mameVersion:null,l.pointsEarned=s[r[c].team]<=5?n:0,a.push(l)}else n-=1}}),e(a)})}function P(r,n,o){var a=e.defer(),i=[];return n.forEach(function(e){if(e.scores){var r=$.map(e.scores,function(e){return e});r=t("orderBy")(r,"-score");for(var n=12,a=0;a<r.length;a++){if(r[a].userName===o){var s=e;s.position=a+1,s.score=r[a].score,s.pointsEarned=n,s.inpUrl=r[a].inpUrl?r[a].inpUrl:null,s.twitchUrl=r[a].twitchUrl?r[a].twitchUrl:null,s.mameVersion=r[a].mameVersion?r[a].mameVersion:null,i.push(s),n=12;break}n>0&&(n-=1)}}}),a.resolve(i),a.promise}function T(){return M}function y(){return G}function F(e){var t=new Firebase(a.FBURL),r=n(t.child("contests").child(e).child("properties"));r.$loaded().then(function(){C=r,C.format.multiGame?(p(e).then(function(e){m()}),C.format.teamBased?i.getTeamList(e).then(function(t){O=t,w(e).then(function(e){var t=e;D=t.length,j=t.slice(0,8)}),S(e).then(function(e){var t=e;M=t.length,G=t.slice(0,8)})}):v(e).then(function(e){var t=e;D=t.length,j=t.slice(0,8)})):g(e).then(function(e){var t=e;D=t.length,j=t}),C.format.teamBased&&i.getTeamList(e).then(function(e){O=e})})}function N(e,t,r,o){var i=new Firebase(a.FBURL),s=n(i.child("contests").child(e)),c=n(i.child("contests").child(e).child("teamPool").child(t.$id).child("players")),l=n(i.child("users").child(r).child("pledgedTo"));s.$loaded().then(function(){s.playerPool[r]={status:"active",team:t.$id,userName:o},s.$save()}),c.$loaded().then(function(){c[o]=!0,c.$save()}),l.$loaded().then(function(){l[e]=!0,l.$save()}),Materialize.toast("You are now registered for IGBY2.",4e3)}function B(t,o,i,s,c,l,u,m){return e(function(e,d){var f=new Firebase(a.FBURL),p=n(f.child("contests").child(t).child("activeGames").child(o.$id).child("scores"));p.$loaded().then(function(){c&&(c=c.replace(/.*?:\/\//g,"")),u&&(u=u.replace(/.*?:\/\//g,"")),l&&(l=l.replace(/.*?:\/\//g,"")),p[r.profile.userName]={score:Number(s),userName:r.profile.userName,twitchUrl:c?c:null,inpUrl:u?u:null,mameVersion:m?m:null,screenshotUrl:l?l:null,team:i},p.$save(),Materialize.toast("Your score was submitted!",4e3),e()})})}var C=null,R=null,D=null,j=null,M=null,G=null,O=null;this.addGame=s,this.createMultiGameFinalStandings=c,this.getEventProperties=l,this.getEventPropertiesObject=u,this.getGameData=d,this.getGameListObject=f,this.getGamesList=p,this.getLeaderboardLengthValue=h,this.getMultiGameLeaderboard=v,this.getPlayerScores=P,this.getPlayerTeamScores=U,this.getPlayerPool=E,this.getSingleGameLeaderboard=g,this.getSummarizedLeaderboardObject=b,this.getTeamBasedMultiGamePlayerLeaderboard=w,this.getTeamGameScores=L,this.getTeamLeaderboardLengthValue=T,this.getTeamListObject=A,this.getTeamSummarizedLeaderboardObject=y,this.loadEventProperties=F,this.submitTeamBasedRegistration=N,this.submitTeamMultiGameScore=B}angular.module("vg.app").service("eventService",e),e.$inject=["$q","$filter","$rootScope","$firebaseObject","$firebaseArray","FIREBASEDATA","teamService"]}(),function(){"use strict";function e(e,t,r,n,o,a,i,s,c,l,u,m){function d(){s.addGame(P.eventName,P.newGame.inputFormalGameName,P.newGame.inputMameRomset,P.newGame.inputRules).then(function(e){P.newGame.inputFormalGameName=null,P.newGame.inputMameRomset=null,P.newGame.inputRules=null,Materialize.toast("Game added.",4e3)})}function f(){var e=r("orderBy")(P.gameScores,"-score"),t={},n=5*P.teamList.length;e.forEach(function(e){t[e.team]?t[e.team]+=1:t[e.team]=1,t[e.team]<=5?(e.points=n,n>0&&(n-=1)):e.points=0})}function p(){angular.element(".modal").closeModal()}function h(){u.createTeam(P.eventName,P.newTeam).then(function(){Materialize.toast("Team "+P.newTeam.shortName+" created.",4e3),P.newTeam=null})}function v(e,t){var n;if(t>11)return n=0;n=12-t;var o=r("orderBy")(P.gameScores,"-score");return o[t-1]&&o[t-1].score===e.score&&(n+=1),n}function g(e){p(),o.go("profile",{username:e})}function $(){s.loadEventProperties(P.eventName),l.getAvatarData().then(function(e){P.avatarData=e}),e.$watchCollection(function(){return s.getEventPropertiesObject()},function(e){P.eventProperties=e},!0),e.$watchCollection(function(){return s.getTeamListObject()},function(e){P.teamList=e},!0),e.$watchCollection(function(){return s.getGameListObject()},function(e){P.gameList=e},!0),s.getPlayerPool(P.eventName).then(function(e){P.playerPool=e}),a(function(){angular.element("ul.tabs").tabs(),angular.element("select").material_select()},600)}function b(e){return"#submitModal"!==e||t.profile?"#submitModal"!==e||t.profile.pledgedTo.igby2?void(1===angular.element("#lean-overlay").length?(p(),a(function(){angular.element(e).openModal(),angular.element(e+"Content").scrollTop(0)},450)):(angular.element(e).openModal(),angular.element(e+"Content").scrollTop(0))):void Materialize.toast("You must be registered to IGBY2 to submit a score.",4e3):void o.go("registerOrLogin")}function w(e){var t=new Firebase(m.FBURL);s.getGameData(P.eventName,e).then(function(e){P.gameData=e,P.gameScores=i(t.child("contests").child(P.eventName).child("activeGames").child(P.gameData.$id).child("scores")),P.gameScores.$loaded().then(function(){P.eventProperties.format.teamBased&&f()})}),b("#gameModal")}function L(){s.getTeamBasedMultiGamePlayerLeaderboard(P.eventName).then(function(e){P.completeLeaderboard=e}),b("#multiGameLeaderboardModal")}function S(e){P.focusPlayer=e,P.eventProperties.format.teamBased?s.getPlayerTeamScores(P.eventName,P.gameList,P.focusPlayer).then(function(e){P.playerScores=e,P.playerScores.length>0&&P.teamList.forEach(function(e){e.$id===P.playerScores[0].team&&(P.playerTeam=e.fullName)})}):s.getPlayerScores(P.eventName,P.gameList,P.focusPlayer).then(function(e){P.playerScores=e}),b("#playerModal")}function A(e){P.focusTeam=e,s.getTeamGameScores(P.eventName,P.focusTeam.key).then(function(e){P.teamScores=e}),b("#teamScoresModal")}function E(){P.regForm.$valid&&(P.disableRegisterButton=!0,P.eventProperties.format.teamBased&&s.submitTeamBasedRegistration(P.eventName,P.selectedRegTeam,t.profile.$id,t.profile.userName))}function U(){return P.submitTwitchUrl||P.submitScreenshotUrl||P.submitInpUrl?void(P.scoreSubmitForm.$valid?P.eventProperties.format.teamBased&&P.eventProperties.format.multiGame&&s.submitTeamMultiGameScore(P.eventName,P.submitSelectedGame,P.playerPool[t.profile.$id].team,P.submitUserScore,P.submitTwitchUrl,P.submitScreenshotUrl,P.submitInpUrl,P.submitInpMameVersion).then(function(e){a(function(){p()},300)}):Materialize.toast("Please be sure all required information is filled out.",4e3)):void Materialize.toast("At least one form of evidence is required.",4e3)}var P=this;P.eventName=n.eventName,P.addGame=d,P.createTeam=h,P.determinePoints=v,P.goToPlayerProfile=g,P.openGameModal=w,P.openModal=b,P.openMultiGameLeaderboardModal=L,P.openPlayerModal=S,P.openTeamScoresModal=A,P.registerForEvent=E,P.submitScore=U,$()}angular.module("vg.app").controller("EventMainController",e),e.$inject=["$scope","$rootScope","$filter","$stateParams","$state","$timeout","$firebaseArray","eventService","authService","profileService","teamService","FIREBASEDATA"]}(),function(){"use strict";function e(e,t,r,n){function o(t,o){var a=e.defer(),i=new Firebase(n.FBURL),s=r(i.child("contests").child(t).child("teamPool"));return s.$loaded().then(function(){s[o.shortName]={fullName:o.formalName},s.$save(),a.resolve()}),a.promise}function a(r){var o=e.defer(),a=new Firebase(n.FBURL),i=t(a.child("contests").child(r).child("teamPool"));return i.$loaded().then(function(){o.resolve(i)}),o.promise}this.createTeam=o,this.getTeamList=a}angular.module("vg.app").service("teamService",e),e.$inject=["$q","$firebaseArray","$firebaseObject","FIREBASEDATA"]}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"E",templateUrl:"./app/eventComponents/gamesList.directive.htm",scope:!1,transclude:!1};return e}function t(e,t){e.$watchCollection(function(){return t.getGameListObject()},function(t){e.$parent.$parent.event.gameList=t},!0)}angular.module("vg.app").directive("vgGamesList",e),t.$inject=["$scope","eventService"]}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"E",templateUrl:"./app/eventComponents/multiGameLeaderboard.directive.htm",scope:!1,transclude:!1};return e}function t(e,t){e.$watchCollection(function(){return t.getLeaderboardLengthValue()},function(t){e.$parent.$parent.event.leaderboardLength=t},!0),e.$watchCollection(function(){return t.getSummarizedLeaderboardObject()},function(t){e.$parent.$parent.event.summarizedLeaderboard=t},!0)}angular.module("vg.app").directive("vgMultiGameLeaderboard",e),t.$inject=["$scope","eventService"]}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"E",templateUrl:"./app/eventComponents/rulesDisplay.directive.htm",scope:!1,transclude:!1};return e}function t(e){e(function(){angular.element(".collapsible").collapsible({accordion:!1})},600)}angular.module("vg.app").directive("vgRulesDisplay",e),t.$inject=["$timeout"]}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"E",templateUrl:"./app/eventComponents/shoutbox.directive.htm",scope:!1,transclude:!1};return e}function t(e,t,r,n,o,a){function i(){s()}function s(){var e=new Firebase(a.FBURL);l.shoutboxData=t(e.child("shoutbox").child("igby2")),l.shoutboxData.$loaded().then(function(){r(function(){$(".shoutbox-panel").scrollTop($(".shoutbox-panel")[0].scrollHeight)},500)})}function c(){console.debug(e.$parent.$parent.event.playerPool);var t={user:n.profile.userName,role:e.$parent.$parent.event.playerPool[n.profile.$id].status,message:l.newMessage,team:e.$parent.$parent.event.playerPool[n.profile.$id].team};l.shoutboxData.$add(t).then(function(){})}var l=this;l.postMessage=c,i()}angular.module("vg.app").directive("vgShoutbox",e),t.$inject=["$scope","$firebaseArray","$timeout","$rootScope","eventService","FIREBASEDATA"]}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"E",templateUrl:"./app/eventComponents/singleGameLeaderboard.directive.htm",scope:!1,transclude:!1};return e}function t(e,t){e.$watchCollection(function(){return t.getLeaderboardLengthValue()},function(t){e.$parent.$parent.event.leaderboardLength=t},!0),e.$watchCollection(function(){return t.getSummarizedLeaderboardObject()},function(t){e.$parent.$parent.event.summarizedLeaderboard=t},!0)}angular.module("vg.app").directive("vgSingleGameLeaderboard",e),t.$inject=["$scope","eventService"]}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"E",templateUrl:"./app/eventComponents/stickyMessage.directive.htm",scope:{properties:"="}};return e}function t(e){}angular.module("vg.app").directive("vgStickyMessage",e),t.$inject=["$timeout"]}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"E",templateUrl:"./app/eventComponents/streamerList.directive.htm",scope:!1,transclude:!1};return e}function t(e,t,r,n,o,a,i,s){function c(){n(function(){l()},2e3)}function l(){var e=new Firebase(s.FBURL);u.activeStreamerList=[],u.igby2PlayerPoolArray=o(e.child("contests").child("igby2").child("playerPool")),u.activeStreamerList=[],u.igby2PlayerPoolArray.$loaded().then(function(){u.igby2PlayerPoolArray.forEach(function(r){var n=a(e.child("users").child(r.$id));n.$loaded().then(function(){n.twitch&&t.jsonp("https://api.twitch.tv/kraken/streams/"+n.twitch+"?callback=JSON_CALLBACK").success(function(e){e.stream&&u.activeStreamerList.push({userName:n.userName,twitch:n.twitch,team:r.team})})})})})}var u=this;u.buildStreamerList=l,c()}angular.module("vg.app").directive("vgStreamerList",e),t.$inject=["$scope","$http","$interval","$timeout","$firebaseArray","$firebaseObject","eventService","FIREBASEDATA"]}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"E",templateUrl:"./app/eventComponents/teamPlayerLeaderboard.directive.htm",scope:!1,transclude:!1};return e}function t(e,t){e.$watchCollection(function(){return t.getLeaderboardLengthValue()},function(t){e.$parent.$parent.event.leaderboardLength=t},!0),e.$watchCollection(function(){return t.getSummarizedLeaderboardObject()},function(t){e.$parent.$parent.event.summarizedLeaderboard=t},!0)}angular.module("vg.app").directive("vgTeamPlayerLeaderboard",e),t.$inject=["$scope","eventService"]}(),function(){"use strict";function e(){var e={bindToController:!0,controller:t,controllerAs:"vm",restrict:"E",templateUrl:"./app/eventComponents/teamTeamsLeaderboard.directive.htm",scope:!1,transclude:!1};return e}function t(e,t){e.$watchCollection(function(){return t.getTeamLeaderboardLengthValue()},function(t){e.$parent.$parent.event.teamLeaderboardLength=t},!0),e.$watchCollection(function(){return t.getTeamSummarizedLeaderboardObject()},function(t){e.$parent.$parent.event.teamSummarizedLeaderboard=t,console.debug(t)},!0)}angular.module("vg.app").directive("vgTeamTeamsLeaderboard",e),t.$inject=["$scope","eventService"]}(),function(){"use strict";function e(e,t,r,n,o){function a(){e(function(){angular.element(".dropdown-button").dropdown({inDuration:300,outDuration:225,constrain_width:!1,hover:!1,gutter:-114,belowOrigin:!0})},400),e(function(){angular.element(".dropdown-button").dropdown({inDuration:300,outDuration:225,constrain_width:!1,hover:!1,gutter:-114,belowOrigin:!0})},1e3)}function i(){o.logOut(),r.location.reload()}var s=this;s.logOut=i,a()}angular.module("vg.app").controller("HeaderController",e),e.$inject=["$timeout","$rootScope","$window","$state","authService"]}(),function(){"use strict";function e(){return{require:"ngModel",link:function(e,t,r,n){function o(e){if(e){var t=e.replace(/[^0-9-]/g,"");return t!==e&&(n.$setViewValue(t),n.$render()),t}return void 0}n.$parsers.push(o)}}}angular.module("vg.app").directive("numbersOnly",e)}(),function(){"use strict";function e(){return function(e,t,r){var n=[];return angular.forEach(e,function(e,t){e.key=t,n.push(e)}),n.sort(function(e,r){return e[t]>r[t]?1:-1}),r&&n.reverse(),n}}angular.module("vg.app").filter("orderObjectBy",e)}(),function(){"use strict";function e(e,t,r,n,o,a,i){function s(){i.getAvatarData().then(function(e){l.avatarData=e}),n(function(){i.getBadgesData(e.profile.userName).then(function(e){l.badgesData=e})},500)}function c(){l.disableButton=!0,a.setAPIKey("Client-ID f53d6d5833b07bc"),a.upload(l.file).then(function(r){i.saveAvatarLink(r[0].link,e.profile.userName),Materialize.toast("Your avatar was uploaded",4e3),n(function(){t.go("home")},1e3)})}var l=this;l.uploadAvatar=c,s()}angular.module("vg.app").controller("AvatarController",e),e.$inject=["$rootScope","$state","$stateParams","$timeout","Upload","imgur","profileService"]}(),function(){"use strict";function e(e,t,r,n){function o(){e.pwChangeForm.$valid&&n.$changePassword({email:n.$getAuth().password.email,oldPassword:a.inputCurrentPassword,newPassword:a.inputNewPassword}).then(function(){Materialize.toast("Your password was changed.",4e3),t(function(){r.go("home")},1e3)})["catch"](function(e){"INVALID_PASSWORD"===e.code&&(a.showChangePasswordMessage=!0)})}var a=this;a.submitChangePassword=o}angular.module("vg.app").controller("ChangePasswordController",e),e.$inject=["$scope","$timeout","$state","AuthWrapper"]}(),function(){"use strict";function e(e,t){}angular.module("vg.app").controller("HomeController",e),e.$inject=["$scope","$timeout"]}(),function(){"use strict";function e(e,t,r,n,o){function a(){i().then(function(e){s.profileScoreData=e}),n.getAvatarData().then(function(e){s.avatarData=e})}function i(){var t=e.defer(),n=new Firebase(o.FBURL),a=r(n.child("badges"));return a.$loaded(function(){t.resolve(a)}),t.promise}var s=this;a()}angular.module("vg.app").controller("LeaderboardController",e),e.$inject=["$q","$timeout","$firebaseArray","profileService","FIREBASEDATA"]}(),function(){"use strict";function e(e,t,r,n,o,a,i,s,c){function l(){s.getUserData(t.username).then(function(e){u.profileData=e,s.getTournamentHistory(u.profileData).then(function(e){var r=e;u.eventStandings=s.getTournamentStandings(r,t.username)})}),s.getAvatarData().then(function(e){u.avatarData=e}),s.getBadgesData(t.username).then(function(e){u.badgesData=e,n(function(){angular.element(".collapsible").collapsible({accordion:!0})},200)})}var u=this;l()}angular.module("vg.app").controller("ProfileController",e),e.$inject=["$scope","$stateParams","$q","$timeout","$state","$firebaseArray","authService","profileService","eventService"]}(),function(){"use strict";function e(e,t,r,n,o,a){function i(){var e=t.defer(),r=new Firebase(a.FBURL),o=n(r.child("avatars"));return o.$loaded(function(){e.resolve(o)}),e.promise}function s(e){var r=t.defer(),o=new Firebase(a.FBURL),i=n(o.child("badges").child(e));return i.$loaded(function(){r.resolve(i)}),r.promise}function c(e){var r=t.defer(),n=(new Firebase(a.FBURL),[]);for(var o in e.pledgedTo)n.push(o);return r.resolve(n),r.promise}function l(e,t){var r=new Firebase(a.FBURL),i=[];return e.forEach(function(e){o.getEventProperties(e).then(function(o){o.$loaded().then(function(){if("concluded"===o.state){var a=n(r.child("standings").child(e));a.$loaded().then(function(){i.push(a[t]?{name:o.name,premier:o.premier?!0:null,shortName:e,state:"concluded",color:o.color,position:a[t]}:{name:o.name,premier:o.premier?!0:null,shortName:e,state:"concluded",color:o.color,position:-1})})}else("inprogress"===o.state||"upcoming"===o.state)&&i.push({name:o.name,premier:o.premier?!0:null,shortName:e,color:o.color,state:o.state})})})}),i}function u(e){var n=t.defer(),o=new Firebase(a.FBURL),i=r(o.child("users"));return i.$loaded(function(){i.forEach(function(t){t.userName===e&&n.resolve(t)})}),n.promise}function m(e,t){var r=new Firebase(a.FBURL),o=n(r.child("avatars"));o.$loaded(function(){o[t]=e,o.$save()})}this.getAvatarData=i,this.getBadgesData=s,this.getTournamentHistory=c,this.getTournamentStandings=l,this.getUserData=u,this.saveAvatarLink=m}angular.module("vg.app").service("profileService",e),e.$inject=["$rootScope","$q","$firebaseArray","$firebaseObject","eventService","FIREBASEDATA"]}(),function(){"use strict";function e(e,t,r,n,o,a,i,s){function c(){i.loginToAccount(m.loginEmail,m.loginPassword).then(function(e){if(m.showInvalidUserError=!1,m.showInvalidPasswordError=!1,"LOGIN_SUCCESS"===e)o.go("home");else{if("INVALID_USER"===e)return void(m.showInvalidUserError=!0);"INVALID_PASSWORD"===e&&(m.showInvalidPasswordError=!0)}})}function l(){return m.loginEmail?void s.$resetPassword({email:m.loginEmail}).then(function(){m.showPasswordResetEmailMessage=!1,Materialize.toast("A password reset email has been sent to "+m.loginEmail+".",4e3)}):void(m.showPasswordResetEmailMessage=!0)}function u(){i.checkIfUserExists(m.newUsername).then(function(e){return m.showDuplicateUserError=!1,m.showEmailTakenError=!1,e?void(m.showDuplicateUserError=!0):void i.createNewUser(m.newEmail,m.newPassword,m.newUsername).then(function(e){return"EMAIL_TAKEN"===e?void(m.showEmailTakenError=!0):void("ACCOUNT_CREATED"===e&&o.go("profile",{username:m.newUsername}))})})}var m=this;m.loginToAccount=c,m.passwordReset=l,m.submitNewAccount=u}angular.module("vg.app").controller("RegController",e),e.$inject=["$scope","$rootScope","$timeout","$window","$state","$firebaseObject","authService","AuthWrapper"]}();